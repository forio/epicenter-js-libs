this.org=this.org||{},org.cometd={},org.cometd.JSON={},org.cometd.JSON.toJSON=org.cometd.JSON.fromJSON=function(a){throw"Abstract"},org.cometd.Utils={},org.cometd.Utils.isString=function(a){return void 0!==a&&null!==a&&("string"==typeof a||a instanceof String)},org.cometd.Utils.isArray=function(a){return void 0!==a&&null!==a&&a instanceof Array},org.cometd.Utils.inArray=function(a,b){for(var c=0;c<b.length;++c)if(a===b[c])return c;return-1},org.cometd.Utils.setTimeout=function(a,b,c){return window.setTimeout(function(){try{a._debug("Invoking timed function",b),b()}catch(c){a._debug("Exception invoking timed function",b,c)}},c)},org.cometd.Utils.clearTimeout=function(a){window.clearTimeout(a)},org.cometd.TransportRegistry=function(){var a=[],b={};this.getTransportTypes=function(){return a.slice(0)},this.findTransportTypes=function(c,d,e){for(var f=[],g=0;g<a.length;++g){var h=a[g];b[h].accept(c,d,e)===!0&&f.push(h)}return f},this.negotiateTransport=function(c,d,e,f){for(var g=0;g<a.length;++g)for(var h=a[g],i=0;i<c.length;++i)if(h===c[i]){var j=b[h];if(j.accept(d,e,f)===!0)return j}return null},this.add=function(c,d,e){for(var f=!1,g=0;g<a.length;++g)if(a[g]===c){f=!0;break}return f||("number"!=typeof e?a.push(c):a.splice(e,0,c),b[c]=d),!f},this.find=function(c){for(var d=0;d<a.length;++d)if(a[d]===c)return b[c];return null},this.remove=function(c){for(var d=0;d<a.length;++d)if(a[d]===c){a.splice(d,1);var e=b[c];return delete b[c],e}return null},this.clear=function(){a=[],b={}},this.reset=function(){for(var c=0;c<a.length;++c)b[a[c]].reset()}},org.cometd.Transport=function(){var a,b;this.registered=function(c,d){a=c,b=d},this.unregistered=function(){a=null,b=null},this._debug=function(){b._debug.apply(b,arguments)},this._mixin=function(){return b._mixin.apply(b,arguments)},this.getConfiguration=function(){return b.getConfiguration()},this.getAdvice=function(){return b.getAdvice()},this.setTimeout=function(a,c){return org.cometd.Utils.setTimeout(b,a,c)},this.clearTimeout=function(a){org.cometd.Utils.clearTimeout(a)},this.convertToMessages=function(a){if(org.cometd.Utils.isString(a))try{return org.cometd.JSON.fromJSON(a)}catch(b){throw this._debug("Could not convert to JSON the following string",'"'+a+'"'),b}if(org.cometd.Utils.isArray(a))return a;if(void 0===a||null===a)return[];if(a instanceof Object)return[a];throw"Conversion Error "+a+", typeof "+typeof a},this.accept=function(a,b,c){throw"Abstract"},this.getType=function(){return a},this.send=function(a,b){throw"Abstract"},this.reset=function(){this._debug("Transport",a,"reset")},this.abort=function(){this._debug("Transport",a,"aborted")},this.toString=function(){return this.getType()}},org.cometd.Transport.derive=function(a){function b(){}return b.prototype=a,new b},org.cometd.RequestTransport=function(){function a(a){for(;l.length>0;){var b=l[0],c=b[0],d=b[1];if(c.url!==a.url||c.sync!==a.sync)break;l.shift(),a.messages=a.messages.concat(c.messages),this._debug("Coalesced",c.messages.length,"messages from request",d.id)}}function b(a,b){if(this.transportSend(a,b),b.expired=!1,!a.sync){var c=this.getConfiguration().maxNetworkDelay,d=c;b.metaConnect===!0&&(d+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"waiting at most",d,"ms for the response, maxNetworkDelay",c);var e=this;b.timeout=this.setTimeout(function(){b.expired=!0;var c="Request "+b.id+" of transport "+e.getType()+" exceeded "+d+" ms max network delay",f={reason:c},g=b.xhr;f.httpCode=e.xhrStatus(g),e.abortXHR(g),e._debug(c),e.complete(b,!1,b.metaConnect),a.onFailure(g,a.messages,f)},d)}}function c(a){var c=++i,d={id:c,metaConnect:!1};k.length<this.getConfiguration().maxConnections-1?(k.push(d),b.call(this,a,d)):(this._debug("Transport",this.getType(),"queueing request",c,"envelope",a),l.push([a,d]))}function d(a){var b=a.id;if(this._debug("Transport",this.getType(),"metaConnect complete, request",b),null!==j&&j.id!==b)throw"Longpoll request mismatch, completing request "+b;j=null}function e(b,d){var e=org.cometd.Utils.inArray(b,k);if(e>=0&&k.splice(e,1),l.length>0){var f=l.shift(),g=f[0],h=f[1];if(this._debug("Transport dequeued request",h.id),d)this.getConfiguration().autoBatch&&a.call(this,g),c.call(this,g),this._debug("Transport completed request",b.id,g);else{var i=this;this.setTimeout(function(){i.complete(h,!1,h.metaConnect);var a={reason:"Previous request failed"},b=h.xhr;a.httpCode=i.xhrStatus(b),g.onFailure(b,g.messages,a)},0)}}}function f(a){if(null!==j)throw"Concurrent metaConnect requests not allowed, request id="+j.id+" not yet completed";var c=++i;this._debug("Transport",this.getType(),"metaConnect send, request",c,"envelope",a);var d={id:c,metaConnect:!0};b.call(this,a,d),j=d}var g=new org.cometd.Transport,h=org.cometd.Transport.derive(g),i=0,j=null,k=[],l=[];return h.complete=function(a,b,c){c?d.call(this,a):e.call(this,a,b)},h.transportSend=function(a,b){throw"Abstract"},h.transportSuccess=function(a,b,c){b.expired||(this.clearTimeout(b.timeout),this.complete(b,!0,b.metaConnect),c&&c.length>0?a.onSuccess(c):a.onFailure(b.xhr,a.messages,{httpCode:204}))},h.transportFailure=function(a,b,c){b.expired||(this.clearTimeout(b.timeout),this.complete(b,!1,b.metaConnect),a.onFailure(b.xhr,a.messages,c))},h.send=function(a,b){b?f.call(this,a):c.call(this,a)},h.abort=function(){g.abort();for(var a=0;a<k.length;++a){var b=k[a];this._debug("Aborting request",b),this.abortXHR(b.xhr)}j&&(this._debug("Aborting metaConnect request",j),this.abortXHR(j.xhr)),this.reset()},h.reset=function(){g.reset(),j=null,k=[],l=[]},h.abortXHR=function(a){if(a)try{a.abort()}catch(a){this._debug(a)}},h.xhrStatus=function(a){if(a)try{return a.status}catch(a){this._debug(a)}return-1},h},org.cometd.LongPollingTransport=function(){var a=new org.cometd.RequestTransport,b=org.cometd.Transport.derive(a),c=!0;return b.accept=function(a,b,d){return c||!b},b.xhrSend=function(a){throw"Abstract"},b.transportSend=function(a,b){this._debug("Transport",this.getType(),"sending request",b.id,"envelope",a);var d=this;try{var e=!0;b.xhr=this.xhrSend({transport:this,url:a.url,sync:a.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(a.messages),onSuccess:function(e){d._debug("Transport",d.getType(),"received response",e);var f=!1;try{var g=d.convertToMessages(e);0===g.length?(c=!1,d.transportFailure(a,b,{httpCode:204})):(f=!0,d.transportSuccess(a,b,g))}catch(e){if(d._debug(e),!f){c=!1;var h={exception:e};h.httpCode=d.xhrStatus(b.xhr),d.transportFailure(a,b,h)}}},onError:function(f,g){c=!1;var h={reason:f,exception:g};h.httpCode=d.xhrStatus(b.xhr),e?d.setTimeout(function(){d.transportFailure(a,b,h)},0):d.transportFailure(a,b,h)}}),e=!1}catch(e){c=!1,this.setTimeout(function(){d.transportFailure(a,b,{exception:e})},0)}},b.reset=function(){a.reset(),c=!0},b},org.cometd.CallbackPollingTransport=function(){function a(a,b,c){var d=this;return function(){d.transportFailure(a,b,"error",c)}}var b=new org.cometd.RequestTransport,c=org.cometd.Transport.derive(b),d=2e3;return c.accept=function(a,b,c){return!0},c.jsonpSend=function(a){throw"Abstract"},c.transportSend=function(b,c){for(var e=this,f=0,g=b.messages.length,h=[];g>0;){var i=org.cometd.JSON.toJSON(b.messages.slice(f,f+g)),j=b.url.length+encodeURI(i).length;if(j>d){if(1===g){var k="Bayeux message too big ("+j+" bytes, max is "+d+") for transport "+this.getType();return void this.setTimeout(a.call(this,b,c,k),0)}--g}else h.push(g),f+=g,g=b.messages.length-f}var l=b;if(h.length>1){var m=0,n=h[0];this._debug("Transport",this.getType(),"split",b.messages.length,"messages into",h.join(" + ")),l=this._mixin(!1,{},b),l.messages=b.messages.slice(m,n),l.onSuccess=b.onSuccess,l.onFailure=b.onFailure;for(var o=1;o<h.length;++o){var p=this._mixin(!1,{},b);m=n,n+=h[o],p.messages=b.messages.slice(m,n),p.onSuccess=b.onSuccess,p.onFailure=b.onFailure,this.send(p,c.metaConnect)}}this._debug("Transport",this.getType(),"sending request",c.id,"envelope",l);try{var q=!0;this.jsonpSend({transport:this,url:l.url,sync:l.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(l.messages),onSuccess:function(a){var b=!1;try{var d=e.convertToMessages(a);0===d.length?e.transportFailure(l,c,{httpCode:204}):(b=!0,e.transportSuccess(l,c,d))}catch(a){e._debug(a),b||e.transportFailure(l,c,{exception:a})}},onError:function(a,b){var d={reason:a,exception:b};q?e.setTimeout(function(){e.transportFailure(l,c,d)},0):e.transportFailure(l,c,d)}}),q=!1}catch(a){this.setTimeout(function(){e.transportFailure(l,c,{exception:a})},0)}},c},org.cometd.WebSocketTransport=function(){function a(){if(!l){l=!0;var a=d.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",a);try{var b=d.getConfiguration().protocol,c=b?new org.cometd.WebSocket(a,b):new org.cometd.WebSocket(a)}catch(a){throw g=!1,this._debug("Exception while creating WebSocket object",a),a}i=d.getConfiguration().stickyReconnect!==!1;var e=this,f=null,h=d.getConfiguration().connectTimeout;h>0&&(f=this.setTimeout(function(){f=null,e._debug("Transport",e.getType(),"timed out while connecting to URL",a,":",h,"ms");var b={code:1e3,reason:"Connect Timeout"};e.webSocketClose(c,b.code,b.reason),e.onClose(c,b)},h));var j=function(){e._debug("WebSocket opened",c),l=!1,f&&(e.clearTimeout(f),f=null),m?(d._warn("Closing Extra WebSocket Connections",c,m),e.webSocketClose(c,1e3,"Extra Connection")):e.onOpen(c)},k=function(a){a=a||{code:1e3},e._debug("WebSocket closing",c,a),l=!1,f&&(e.clearTimeout(f),f=null),null!==m&&c!==m?e._debug("Closed Extra WebSocket Connection",c):e.onClose(c,a)},n=function(a){e._debug("WebSocket message",a,c),c!==m&&d._warn("Extra WebSocket Connections",c,m),e.onMessage(c,a)};c.onopen=j,c.onclose=k,c.onerror=function(){k({code:1002,reason:"Error"})},c.onmessage=n,this._debug("Transport",this.getType(),"configured callbacks on",c)}}function b(a,b,c){var d=org.cometd.JSON.toJSON(b.messages);a.send(d),this._debug("Transport",this.getType(),"sent",b,"metaConnect =",c);var e=this.getConfiguration().maxNetworkDelay,f=e;c&&(f+=this.getAdvice().timeout,n=!0);for(var g=this,h=[],i=0;i<b.messages.length;++i)!function(){var c=b.messages[i];c.id&&(h.push(c.id),k[c.id]=this.setTimeout(function(){g._debug("Transport",g.getType(),"timing out message",c.id,"after",f,"on",a);var b={code:1e3,reason:"Message Timeout"};g.webSocketClose(a,b.code,b.reason),g.onClose(a,b)},f))}();this._debug("Transport",this.getType(),"waiting at most",f,"ms for messages",h,"maxNetworkDelay",e,", timeouts:",k)}function c(c,d,e){try{null===c?a.call(this):b.call(this,c,d,e)}catch(a){this.setTimeout(function(){d.onFailure(c,d.messages,{exception:a})},0)}}var d,e=new org.cometd.Transport,f=org.cometd.Transport.derive(e),g=!0,h=!1,i=!0,j={},k={},l=!1,m=null,n=!1,o=null;return f.reset=function(){e.reset(),g=!0,h=!1,i=!0,j={},k={},l=!1,m=null,n=!1,o=null},f.onOpen=function(a){this._debug("Transport",this.getType(),"opened",a),m=a,h=!0,this._debug("Sending pending messages",j);for(var c in j){var d=j[c],e=d[0],f=d[1];o=e.onSuccess,b.call(this,a,e,f)}},f.onMessage=function(a,b){this._debug("Transport",this.getType(),"received websocket message",b,a);for(var c=!1,d=this.convertToMessages(b.data),e=[],f=0;f<d.length;++f){var g=d[f];if((/^\/meta\//.test(g.channel)||void 0!==g.successful)&&g.id){e.push(g.id);var h=k[g.id];h&&(this.clearTimeout(h),delete k[g.id],this._debug("Transport",this.getType(),"removed timeout for message",g.id,", timeouts",k))}"/meta/connect"===g.channel&&(n=!1),"/meta/disconnect"!==g.channel||n||(c=!0)}for(var i=!1,l=0;l<e.length;++l){var m=e[l];for(var p in j){var q=p.split(","),r=org.cometd.Utils.inArray(m,q);if(r>=0){i=!0,q.splice(r,1);var s=j[p][0],t=j[p][1];delete j[p],q.length>0&&(j[q.join(",")]=[s,t]);break}}}i&&this._debug("Transport",this.getType(),"removed envelope, envelopes",j),o.call(this,d),c&&this.webSocketClose(a,1e3,"Disconnect")},f.onClose=function(a,b){this._debug("Transport",this.getType(),"closed",a,b),g=i&&h;var c=k;k={};for(var d in c)this.clearTimeout(c[d]);var e=j;j={};for(var f in e){var l=e[f][0],o=e[f][1];o&&(n=!1),l.onFailure(a,l.messages,{websocketCode:b.code,reason:b.reason})}m=null},f.registered=function(a,b){e.registered(a,b),d=b},f.accept=function(a,b,c){return g&&!!org.cometd.WebSocket&&d.websocketEnabled!==!1},f.send=function(a,b){this._debug("Transport",this.getType(),"sending",a,"metaConnect =",b);for(var d=[],e=0;e<a.messages.length;++e){var f=a.messages[e];f.id&&d.push(f.id)}j[d.join(",")]=[a,b],this._debug("Transport",this.getType(),"stored envelope, envelopes",j),c.call(this,m,a,b)},f.webSocketClose=function(a,b,c){try{a.close(b,c)}catch(a){this._debug(a)}},f.abort=function(){if(e.abort(),m){var a={code:1001,reason:"Abort"};this.webSocketClose(m,a.code,a.reason),this.onClose(m,a)}this.reset()},f},org.cometd.CometD=function(a){function b(a,b){try{return a[b]}catch(a){return}}function c(a){return org.cometd.Utils.isString(a)}function d(a){return void 0!==a&&null!==a&&"function"==typeof a}function e(a,b){if(window.console){var c=window.console[a];d(c)&&c.apply(window.console,b)}}function f(a){fa._debug("Configuring cometd object with",a),c(a)&&(a={url:a}),a||(a={}),xa=fa._mixin(!1,xa,a);var b=fa.getURL();if(!b)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var d=/(^https?:\/\/)?(((\[[^\]]+\])|([^:\/\?#]+))(:(\d+))?)?([^\?#]*)(.*)?/.exec(b),e=d[2],f=d[8],g=d[9];if(ha=fa._isCrossDomain(e),xa.appendMessageTypeToURL)if(void 0!==g&&g.length>0)fa._info("Appending message type to URI "+f+g+" is not supported, disabling 'appendMessageTypeToURL' configuration"),xa.appendMessageTypeToURL=!1;else{var h=f.split("/"),i=h.length-1;f.match(/\/$/)&&(i-=1),h[i].indexOf(".")>=0&&(fa._info("Appending message type to URI "+f+" is not supported, disabling 'appendMessageTypeToURL' configuration"),xa.appendMessageTypeToURL=!1)}}function g(a){if(a){var b=pa[a.channel];b&&b[a.id]&&(delete b[a.id],fa._debug("Removed",a.listener?"listener":"subscription",a))}}function h(a){a&&!a.listener&&g(a)}function i(){for(var a in pa){var b=pa[a];if(b)for(var c=0;c<b.length;++c)h(b[c])}}function j(a){ja!==a&&(fa._debug("Status",ja,"->",a),ja=a)}function k(){return"disconnecting"===ja||"disconnected"===ja}function l(){return++ka}function m(a,b,c,e,f){try{return b.call(a,e)}catch(a){fa._debug("Exception during execution of extension",c,a);var g=fa.onExtensionException;if(d(g)){fa._debug("Invoking extension exception callback",c,a);try{g.call(fa,a,c,f,e)}catch(a){fa._info("Exception during execution of exception callback in extension",c,a)}}return e}}function n(a){for(var b=0;b<sa.length&&(void 0!==a&&null!==a);++b){var c=xa.reverseIncomingExtensions?sa.length-1-b:b,e=sa[c],f=e.extension.incoming;if(d(f)){var g=m(e.extension,f,e.name,a,!1);a=void 0===g?a:g}}return a}function o(a){for(var b=0;b<sa.length&&(void 0!==a&&null!==a);++b){var c=sa[b],e=c.extension.outgoing;if(d(e)){var f=m(c.extension,e,c.name,a,!0);a=void 0===f?a:f}}return a}function p(a,b){var c=pa[a];if(c&&c.length>0)for(var e=0;e<c.length;++e){var f=c[e];if(f)try{f.callback.call(f.scope,b)}catch(a){fa._debug("Exception during notification",f,b,a);var g=fa.onListenerException;if(d(g)){fa._debug("Invoking listener exception callback",f,a);try{g.call(fa,a,f,f.listener,b)}catch(a){fa._info("Exception during execution of listener callback",f,a)}}}}}function q(a,b){p(a,b);for(var c=a.split("/"),d=c.length-1,e=d;e>0;--e){var f=c.slice(0,e).join("/")+"/*";e===d&&p(f,b),f+="*",p(f,b)}}function r(){null!==ra&&org.cometd.Utils.clearTimeout(ra),ra=null}function s(a){r();var b=ta.interval+qa;fa._debug("Function scheduled in",b,"ms, interval =",ta.interval,"backoff =",qa,a),ra=org.cometd.Utils.setTimeout(fa,a,b)}function t(a,b,c,e){for(var f=0;f<b.length;++f){var g=b[f],h=""+l();g.id=h,la&&(g.clientId=la);var i=void 0;d(g._callback)&&(i=g._callback,delete g._callback),g=o(g),void 0!==g&&null!==g?(g.id=h,b[f]=g,i&&(ua[h]=i)):b.splice(f--,1)}if(0!==b.length){var j=fa.getURL();xa.appendMessageTypeToURL&&(j.match(/\/$/)||(j+="/"),e&&(j+=e));var k={url:j,sync:a,messages:b,onSuccess:function(a){try{ya.call(fa,a)}catch(a){fa._debug("Exception during handling of messages",a)}},onFailure:function(a,b,c){try{var d=fa.getTransport();c.connectionType=d?d.getType():"unknown",za.call(fa,a,b,c)}catch(a){fa._debug("Exception during handling of failure",a)}}};fa._debug("Send",k),ca.send(k,c)}}function u(a){ma>0||oa===!0?na.push(a):t(!1,[a],!1)}function v(){qa=0}function w(){qa<xa.maxBackoff&&(qa+=xa.backoffIncrement)}function x(){++ma}function y(){var a=na;na=[],a.length>0&&t(!1,a,!1)}function z(){if(--ma,ma<0)throw"Calls to startBatch() and endBatch() are not paired";0!==ma||k()||oa||y()}function A(){if(!k()){var a={channel:"/meta/connect",connectionType:ca.getType()};wa||(a.advice={timeout:0}),j("connecting"),fa._debug("Connect sent",a),t(!1,[a],!0,"connect"),j("connected")}}function B(){j("connecting"),s(function(){A()})}function C(a){a&&(ta=fa._mixin(!1,{},xa.advice,a),fa._debug("New advice",ta))}function D(a){if(r(),a&&ca&&ca.abort(),la=null,j("disconnected"),ma=0,v(),ca=null,na.length>0){var b=na;na=[],za.call(fa,void 0,b,{reason:"Disconnected"})}}function E(a,b,c){var e=fa.onTransportFailure;if(d(e)){fa._debug("Invoking transport failure callback",a,b,c);try{e.call(fa,a,b,c)}catch(a){fa._info("Exception during execution of transport failure callback",a)}}}function F(a,b){d(a)&&(b=a,a=void 0),la=null,i(),k()?(ia.reset(),C(xa.advice)):C(fa._mixin(!1,ta,{reconnect:"retry"})),ma=0,oa=!0,da=a,ea=b;var c="1.0",e=fa.getURL(),f=ia.findTransportTypes(c,ha,e),g={version:c,minimumVersion:c,channel:"/meta/handshake",supportedConnectionTypes:f,_callback:b,advice:{timeout:ta.timeout,interval:ta.interval}},h=fa._mixin(!1,{},da,g);if(!ca&&(ca=ia.negotiateTransport(f,c,ha,e),!ca)){var l="Could not find initial transport among: "+ia.getTransportTypes();throw fa._warn(l),l}fa._debug("Initial transport is",ca.getType()),j("handshaking"),fa._debug("Handshake sent",h),t(!1,[h],!1,"handshake")}function G(){j("handshaking"),oa=!0,s(function(){F(da,ea)})}function H(a){var b=ua[a.id];d(b)&&(delete ua[a.id],b.call(fa,a))}function I(a){H(a),q("/meta/handshake",a),q("/meta/unsuccessful",a);var b=!k()&&"none"!==ta.reconnect;b?(w(),G()):D(!1)}function J(a){if(a.successful){la=a.clientId;var b=fa.getURL(),c=ia.negotiateTransport(a.supportedConnectionTypes,a.version,ha,b);if(null===c){var d="Could not negotiate transport with server; client=["+ia.findTransportTypes(a.version,ha,b)+"], server=["+a.supportedConnectionTypes+"]",e=fa.getTransport();return E(e.getType(),null,{reason:d,connectionType:e.getType(),transport:e}),fa._warn(d),void D(!0)}ca!==c&&(fa._debug("Transport",ca.getType(),"->",c.getType()),ca=c),oa=!1,y(),a.reestablish=va,va=!0,H(a),q("/meta/handshake",a);var f=k()?"none":ta.reconnect;switch(f){case"retry":v(),B();break;case"none":D(!1);break;default:throw"Unrecognized advice action "+f}}else I(a)}function K(a){var b="1.0",c=fa.getURL(),d=fa.getTransport(),e=ia.findTransportTypes(b,ha,c),f=ia.negotiateTransport(e,b,ha,c);f?(fa._debug("Transport",d.getType(),"->",f.getType()),E(d.getType(),f.getType(),a.failure),I(a),ca=f):(E(d.getType(),null,a.failure),fa._warn("Could not negotiate transport; client=["+e+"]"),D(!0),I(a))}function L(a){q("/meta/connect",a),q("/meta/unsuccessful",a);var b=k()?"none":ta.reconnect;switch(b){case"retry":B(),w();break;case"handshake":ia.reset(),v(),G();break;case"none":D(!1);break;default:throw"Unrecognized advice action"+b}}function M(a){if(wa=a.successful){q("/meta/connect",a);var b=k()?"none":ta.reconnect;switch(b){case"retry":v(),B();break;case"none":D(!1);break;default:throw"Unrecognized advice action "+b}}else L(a)}function N(a){wa=!1,L(a)}function O(a){D(!0),H(a),q("/meta/disconnect",a),q("/meta/unsuccessful",a)}function P(a){a.successful?(D(!1),H(a),q("/meta/disconnect",a)):O(a)}function Q(a){O(a)}function R(a){var b=pa[a.subscription];if(b)for(var c=b.length-1;c>=0;--c){var d=b[c];if(d&&!d.listener){delete b[c],fa._debug("Removed failed subscription",d);break}}H(a),q("/meta/subscribe",a),q("/meta/unsuccessful",a)}function S(a){a.successful?(H(a),q("/meta/subscribe",a)):R(a)}function T(a){R(a)}function U(a){H(a),q("/meta/unsubscribe",a),q("/meta/unsuccessful",a)}function V(a){a.successful?(H(a),q("/meta/unsubscribe",a)):U(a)}function W(a){U(a)}function X(a){H(a),q("/meta/publish",a),q("/meta/unsuccessful",a)}function Y(a){void 0===a.successful?void 0!==a.data?q(a.channel,a):fa._warn("Unknown Bayeux Message",a):a.successful?(H(a),q("/meta/publish",a)):X(a)}function Z(a){X(a)}function $(a){if(a=n(a),void 0!==a&&null!==a){C(a.advice);var b=a.channel;switch(b){case"/meta/handshake":J(a);break;case"/meta/connect":M(a);break;case"/meta/disconnect":P(a);break;case"/meta/subscribe":S(a);break;case"/meta/unsubscribe":V(a);break;default:Y(a)}}}function _(a){var b=pa[a];if(b)for(var c=0;c<b.length;++c)if(b[c])return!0;return!1}function aa(a,b){var e={scope:a,method:b};if(d(a))e.scope=void 0,e.method=a;else if(c(b)){if(!a)throw"Invalid scope "+a;if(e.method=a[b],!d(e.method))throw"Invalid callback "+b+" for scope "+a}else if(!d(b))throw"Invalid callback "+b;return e}function ba(a,b,c,d){var e=aa(b,c);fa._debug("Adding",d?"listener":"subscription","on",a,"with scope",e.scope,"and callback",e.method);var f={channel:a,scope:e.scope,callback:e.method,listener:d},g=pa[a];return g||(g=[],pa[a]=g),f.id=g.push(f)-1,fa._debug("Added",d?"listener":"subscription",f),f[0]=a,f[1]=f.id,f}var ca,da,ea,fa=this,ga=a||"default",ha=!1,ia=new org.cometd.TransportRegistry,ja="disconnected",ka=0,la=null,ma=0,na=[],oa=!1,pa={},qa=0,ra=null,sa=[],ta={},ua={},va=!1,wa=!1,xa={protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",reverseIncomingExtensions:!0,maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,advice:{timeout:6e4,interval:0,reconnect:"retry"}};this._mixin=function(a,c,d){for(var e=c||{},f=2;f<arguments.length;++f){var g=arguments[f];if(void 0!==g&&null!==g)for(var h in g){var i=b(g,h),j=b(e,h);if(i!==c&&void 0!==i)if(a&&"object"==typeof i&&null!==i)if(i instanceof Array)e[h]=this._mixin(a,j instanceof Array?j:[],i);else{var k="object"!=typeof j||j instanceof Array?{}:j;e[h]=this._mixin(a,k,i)}else e[h]=i}}return e},this._warn=function(){e("warn",arguments)},this._info=function(){"warn"!==xa.logLevel&&e("info",arguments)},this._debug=function(){"debug"===xa.logLevel&&e("debug",arguments)},this._isCrossDomain=function(a){return a&&a!==window.location.host};var ya,za;this.send=u,this.receive=$,ya=function(a){fa._debug("Received",a);for(var b=0;b<a.length;++b){var c=a[b];$(c)}},za=function(a,b,c){fa._debug("handleFailure",a,b,c),c.transport=a;for(var d=0;d<b.length;++d){var e=b[d],f={id:e.id,successful:!1,channel:e.channel,failure:c};switch(c.message=e,e.channel){case"/meta/handshake":K(f);break;case"/meta/connect":N(f);break;case"/meta/disconnect":Q(f);break;case"/meta/subscribe":f.subscription=e.subscription,T(f);break;case"/meta/unsubscribe":f.subscription=e.subscription,W(f);break;default:Z(f)}}},this.registerTransport=function(a,b,c){var e=ia.add(a,b,c);return e&&(this._debug("Registered transport",a),d(b.registered)&&b.registered(a,this)),e},this.getTransportTypes=function(){return ia.getTransportTypes()},this.unregisterTransport=function(a){var b=ia.remove(a);return null!==b&&(this._debug("Unregistered transport",a),d(b.unregistered)&&b.unregistered()),b},this.unregisterTransports=function(){ia.clear()},this.findTransport=function(a){return ia.find(a)},this.configure=function(a){f.call(this,a)},this.init=function(a,b){this.configure(a),this.handshake(b)},this.handshake=function(a,b){j("disconnected"),va=!1,F(a,b)},this.disconnect=function(a,b,c){if(!k()){"boolean"!=typeof a&&(c=b,b=a,a=!1),d(b)&&(c=b,b=void 0);var e={channel:"/meta/disconnect",_callback:c},f=this._mixin(!1,{},b,e);j("disconnecting"),t(a===!0,[f],!1,"disconnect")}},this.startBatch=function(){x()},this.endBatch=function(){z()},this.batch=function(a,b){var c=aa(a,b);this.startBatch();try{c.method.call(c.scope),this.endBatch()}catch(a){throw this._info("Exception during execution of batch",a),this.endBatch(),a}},this.addListener=function(a,b,d){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!c(a))throw"Illegal argument type: channel must be a string";return ba(a,b,d,!0)},this.removeListener=function(a){if(!(a&&a.channel&&"id"in a))throw"Invalid argument: expected subscription, not "+a;g(a)},this.clearListeners=function(){pa={}},this.subscribe=function(a,b,e,f,g){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!c(a))throw"Illegal argument type: channel must be a string";if(k())throw"Illegal state: already disconnected";d(b)&&(g=f,f=e,e=b,b=void 0),d(f)&&(g=f,f=void 0);var h=!_(a),i=ba(a,b,e,!1);if(h){var j={channel:"/meta/subscribe",subscription:a,_callback:g},l=this._mixin(!1,{},f,j);u(l)}return i},this.unsubscribe=function(a,b,c){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(k())throw"Illegal state: already disconnected";d(b)&&(c=b,b=void 0),this.removeListener(a);var e=a.channel;if(!_(e)){var f={channel:"/meta/unsubscribe",subscription:e,_callback:c},g=this._mixin(!1,{},b,f);u(g)}},this.resubscribe=function(a,b){if(h(a),a)return this.subscribe(a.channel,a.scope,a.callback,b)},this.clearSubscriptions=function(){i()},this.publish=function(a,b,e,f){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!c(a))throw"Illegal argument type: channel must be a string";if(/^\/meta\//.test(a))throw"Illegal argument: cannot publish to meta channels";if(k())throw"Illegal state: already disconnected";d(b)?(f=b,b=e={}):d(e)&&(f=e,e={});var g={channel:a,data:b,_callback:f},h=this._mixin(!1,{},e,g);u(h)},this.getStatus=function(){return ja},this.isDisconnected=k,this.setBackoffIncrement=function(a){xa.backoffIncrement=a},this.getBackoffIncrement=function(){return xa.backoffIncrement},this.getBackoffPeriod=function(){return qa},this.setLogLevel=function(a){xa.logLevel=a},this.registerExtension=function(a,b){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!c(a))throw"Illegal argument type: extension name must be a string";for(var e=!1,f=0;f<sa.length;++f){var g=sa[f];if(g.name===a){e=!0;break}}return e?(this._info("Could not register extension with name",a,"since another extension with the same name already exists"),!1):(sa.push({name:a,extension:b}),this._debug("Registered extension",a),d(b.registered)&&b.registered(a,this),!0)},this.unregisterExtension=function(a){if(!c(a))throw"Illegal argument type: extension name must be a string";for(var b=!1,e=0;e<sa.length;++e){var f=sa[e];if(f.name===a){sa.splice(e,1),b=!0,this._debug("Unregistered extension",a);var g=f.extension;d(g.unregistered)&&g.unregistered();break}}return b},this.getExtension=function(a){for(var b=0;b<sa.length;++b){var c=sa[b];if(c.name===a)return c.extension}return null},this.getName=function(){return ga},this.getClientId=function(){return la},this.getURL=function(){if(ca&&"object"==typeof xa.urls){var a=xa.urls[ca.getType()];if(a)return a}return xa.url},this.getTransport=function(){return ca},this.getConfiguration=function(){return this._mixin(!0,{},xa)},this.getAdvice=function(){return this._mixin(!0,{},ta)},org.cometd.WebSocket=window.WebSocket},"function"==typeof define&&define.amd&&define(function(){return org.cometd}),function(){function a(a){return a.AckExtension=function(){function a(a,c){b._debug(a,c)}var b,c=!1,d=-1;this.registered=function(c,d){b=d,a("AckExtension: executing registration callback")},this.unregistered=function(){a("AckExtension: executing unregistration callback"),b=null},this.incoming=function(b){var e=b.channel;if("/meta/handshake"==e)c=b.ext&&b.ext.ack,a("AckExtension: server supports acks",c);else if("/meta/connect"==e&&b.successful&&c){var f=b.ext;f&&"number"==typeof f.ack&&(d=f.ack,a("AckExtension: server sent ack id",d))}return b},this.outgoing=function(e){var f=e.channel;return"/meta/handshake"==f?(e.ext||(e.ext={}),e.ext.ack=b&&b.ackEnabled!==!1,d=-1):"/meta/connect"==f&&c&&(e.ext||(e.ext={}),e.ext.ack=d,a("AckExtension: client sending ack id",d)),e}}}"function"==typeof define&&define.amd?define(["org/cometd"],a):a(org.cometd)}(),function(){function a(a){return a.COOKIE||(a.COOKIE={},a.COOKIE.set=function(a,b,c){throw"Abstract"},a.COOKIE.get=function(a){throw"Abstract"}),a.ReloadExtension=function(b){function c(b){if(h&&null!==h.handshakeResponse){e(b),h.cookiePath=j;var c=a.JSON.toJSON(h);g("Reload extension saving cookie value",c),a.COOKIE.set(i,c,{"max-age":k,path:j,expires:new Date((new Date).getTime()+1e3*k)})}}function d(a){return h.url==a.url}function e(a){a&&("number"==typeof a.cookieMaxAge&&(k=a.cookieMaxAge),"string"==typeof a.cookieName&&(i=a.cookieName),"string"==typeof a.cookiePath&&(j=a.cookiePath))}var f,g,h=null,i="org.cometd.reload",j="/",k=5,l=!1;this.configure=e,this.registered=function(a,b){f=b,f.reload=c,g=f._debug},this.unregistered=function(){delete f.reload,f=null},this.outgoing=function(b){switch(b.channel){case"/meta/handshake":h={},h.url=f.getURL();var c=a.COOKIE.get(i);if(g("Reload extension found cookie value",c),c)try{var e=a.JSON.fromJSON(c);if(a.COOKIE.set(i,"",{"max-age":-1,path:e.cookiePath,expires:-1}),e.handshakeResponse&&d(e))return g("Reload extension restoring state",e),setTimeout(function(){g("Reload extension replaying handshake response",e.handshakeResponse),h.handshakeResponse=e.handshakeResponse,h.transportType=e.transportType,h.reloading=!0;var a=f._mixin(!0,{},h.handshakeResponse,{ext:{reload:!0}});a.supportedConnectionTypes=[h.transportType],f.receive(a),g("Reload extension replayed handshake response",a)},0),l||(l=!0,f.startBatch()),null;g("Reload extension could not restore state",e)}catch(a){g("Reload extension error while trying to restore cookie",a)}break;case"/meta/connect":h.transportType||(h.transportType=b.connectionType,g("Reload extension tracked transport type",h.transportType));break;case"/meta/disconnect":h=null}return b},this.incoming=function(a){if(a.successful)switch(a.channel){case"/meta/handshake":h.handshakeResponse||(h.handshakeResponse=a,g("Reload extension tracked handshake response",a));break;case"/meta/disconnect":h=null;break;case"/meta/connect":l&&(f.endBatch(),l=!1)}return a},e(b)}}"function"==typeof define&&define.amd?define(["org/cometd"],a):a(org.cometd)}(),function(){function a(a,b){function c(a,b){if(b)for(var c in b)"content-type"!==c.toLowerCase()&&a.setRequestHeader(c,b[c])}function d(){var d=new b.LongPollingTransport,e=b.Transport.derive(d);return e.xhrSend=function(b){return a.ajax({url:b.url,async:b.sync!==!0,type:"POST",contentType:"application/json;charset=UTF-8",data:b.body,beforeSend:function(a){return a.withCredentials=!0,c(a,b.headers),!0},success:b.onSuccess,error:function(a,c,d){b.onError(c,d)}})},e}function e(){var d=new b.CallbackPollingTransport,e=b.Transport.derive(d);return e.jsonpSend=function(b){a.ajax({url:b.url,async:b.sync!==!0,type:"GET",dataType:"jsonp",jsonp:"jsonp",data:{message:b.body},beforeSend:function(a){return c(a,b.headers),!0},success:b.onSuccess,error:function(a,c,d){b.onError(c,d)}})},e}return b.JSON.toJSON=JSON.stringify,b.JSON.fromJSON=JSON.parse,a.CometD=function(a){var c=new b.CometD(a);return b.WebSocket&&c.registerTransport("websocket",new b.WebSocketTransport),c.registerTransport("long-polling",new d),c.registerTransport("callback-polling",new e),c},a.cometd=new a.CometD,a.cometd}"function"==typeof define&&define.amd?define(["jquery","org/cometd"],a):a(jQuery,org.cometd)}(),function(){function a(a,b){var c=new a;return b.registerExtension("ack",c),c}"function"==typeof define&&define.amd?define(["org/cometd/AckExtension","jquery.cometd"],a):a(org.cometd.AckExtension,jQuery.cometd)}(),function(){function a(a,b,c,d){
b&&(a.COOKIE.set=b,a.COOKIE.get=b);var e=new c;return d.registerExtension("reload",e),e}"function"==typeof define&&define.amd?define(["org/cometd","jquery.cookie","org/cometd/ReloadExtension","jquery.cometd"],a):a(org.cometd,jQuery.cookie,org.cometd.ReloadExtension,jQuery.cometd)}();
//# sourceMappingURL=epicenter-multiplayer-dependencies.min.js.map