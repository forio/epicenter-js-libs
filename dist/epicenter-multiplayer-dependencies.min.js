this.org=this.org||{},org.cometd={},org.cometd.JSON={},org.cometd.JSON.toJSON=org.cometd.JSON.fromJSON=function(){throw"Abstract"},org.cometd.Utils={},org.cometd.Utils.isString=function(a){return void 0===a||null===a?!1:"string"==typeof a||a instanceof String},org.cometd.Utils.isArray=function(a){return void 0===a||null===a?!1:a instanceof Array},org.cometd.Utils.inArray=function(a,b){for(var c=0;c<b.length;++c)if(a===b[c])return c;return-1},org.cometd.Utils.setTimeout=function(a,b,c){return window.setTimeout(function(){try{b()}catch(c){a._debug("Exception invoking timed function",b,c)}},c)},org.cometd.Utils.clearTimeout=function(a){window.clearTimeout(a)},org.cometd.TransportRegistry=function(){var a=[],b={};this.getTransportTypes=function(){return a.slice(0)},this.findTransportTypes=function(c,d,e){for(var f=[],g=0;g<a.length;++g){var h=a[g];b[h].accept(c,d,e)===!0&&f.push(h)}return f},this.negotiateTransport=function(c,d,e,f){for(var g=0;g<a.length;++g)for(var h=a[g],i=0;i<c.length;++i)if(h===c[i]){var j=b[h];if(j.accept(d,e,f)===!0)return j}return null},this.add=function(c,d,e){for(var f=!1,g=0;g<a.length;++g)if(a[g]===c){f=!0;break}return f||("number"!=typeof e?a.push(c):a.splice(e,0,c),b[c]=d),!f},this.find=function(c){for(var d=0;d<a.length;++d)if(a[d]===c)return b[c];return null},this.remove=function(c){for(var d=0;d<a.length;++d)if(a[d]===c){a.splice(d,1);var e=b[c];return delete b[c],e}return null},this.clear=function(){a=[],b={}},this.reset=function(){for(var c=0;c<a.length;++c)b[a[c]].reset()}},org.cometd.Transport=function(){var a,b;this.registered=function(c,d){a=c,b=d},this.unregistered=function(){a=null,b=null},this._debug=function(){b._debug.apply(b,arguments)},this._mixin=function(){return b._mixin.apply(b,arguments)},this.getConfiguration=function(){return b.getConfiguration()},this.getAdvice=function(){return b.getAdvice()},this.setTimeout=function(a,c){return org.cometd.Utils.setTimeout(b,a,c)},this.clearTimeout=function(a){org.cometd.Utils.clearTimeout(a)},this.convertToMessages=function(a){if(org.cometd.Utils.isString(a))try{return org.cometd.JSON.fromJSON(a)}catch(b){throw this._debug("Could not convert to JSON the following string",'"'+a+'"'),b}if(org.cometd.Utils.isArray(a))return a;if(void 0===a||null===a)return[];if(a instanceof Object)return[a];throw"Conversion Error "+a+", typeof "+typeof a},this.accept=function(){throw"Abstract"},this.getType=function(){return a},this.send=function(){throw"Abstract"},this.reset=function(){this._debug("Transport",a,"reset")},this.abort=function(){this._debug("Transport",a,"aborted")},this.toString=function(){return this.getType()}},org.cometd.Transport.derive=function(a){function b(){}return b.prototype=a,new b},org.cometd.RequestTransport=function(){function a(a){for(;l.length>0;){var b=l[0],c=b[0],d=b[1];if(c.url!==a.url||c.sync!==a.sync)break;l.shift(),a.messages=a.messages.concat(c.messages),this._debug("Coalesced",c.messages.length,"messages from request",d.id)}}function b(a,b){if(this.transportSend(a,b),b.expired=!1,!a.sync){var c=this.getConfiguration().maxNetworkDelay,d=c;b.metaConnect===!0&&(d+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"waiting at most",d,"ms for the response, maxNetworkDelay",c);var e=this;b.timeout=this.setTimeout(function(){b.expired=!0;var c="Request "+b.id+" of transport "+e.getType()+" exceeded "+d+" ms max network delay",f={reason:c},g=b.xhr;f.httpCode=e.xhrStatus(g),e.abortXHR(g),e._debug(c),e.complete(b,!1,b.metaConnect),a.onFailure(g,a.messages,f)},d)}}function c(a){var c=++i,d={id:c,metaConnect:!1};k.length<this.getConfiguration().maxConnections-1?(k.push(d),b.call(this,a,d)):(this._debug("Transport",this.getType(),"queueing request",c,"envelope",a),l.push([a,d]))}function d(a){var b=a.id;if(this._debug("Transport",this.getType(),"metaConnect complete, request",b),null!==j&&j.id!==b)throw"Longpoll request mismatch, completing request "+b;j=null}function e(b,d){var e=org.cometd.Utils.inArray(b,k);if(e>=0&&k.splice(e,1),l.length>0){var f=l.shift(),g=f[0],h=f[1];if(this._debug("Transport dequeued request",h.id),d)this.getConfiguration().autoBatch&&a.call(this,g),c.call(this,g),this._debug("Transport completed request",b.id,g);else{var i=this;this.setTimeout(function(){i.complete(h,!1,h.metaConnect);var a={reason:"Previous request failed"},b=h.xhr;a.httpCode=i.xhrStatus(b),g.onFailure(b,g.messages,a)},0)}}}function f(a){if(null!==j)throw"Concurrent metaConnect requests not allowed, request id="+j.id+" not yet completed";var c=++i;this._debug("Transport",this.getType(),"metaConnect send, request",c,"envelope",a);var d={id:c,metaConnect:!0};b.call(this,a,d),j=d}var g=new org.cometd.Transport,h=org.cometd.Transport.derive(g),i=0,j=null,k=[],l=[];return h.complete=function(a,b,c){c?d.call(this,a):e.call(this,a,b)},h.transportSend=function(){throw"Abstract"},h.transportSuccess=function(a,b,c){b.expired||(this.clearTimeout(b.timeout),this.complete(b,!0,b.metaConnect),c&&c.length>0?a.onSuccess(c):a.onFailure(b.xhr,a.messages,{httpCode:204}))},h.transportFailure=function(a,b,c){b.expired||(this.clearTimeout(b.timeout),this.complete(b,!1,b.metaConnect),a.onFailure(b.xhr,a.messages,c))},h.send=function(a,b){b?f.call(this,a):c.call(this,a)},h.abort=function(){g.abort();for(var a=0;a<k.length;++a){var b=k[a];this._debug("Aborting request",b),this.abortXHR(b.xhr)}j&&(this._debug("Aborting metaConnect request",j),this.abortXHR(j.xhr)),this.reset()},h.reset=function(){g.reset(),j=null,k=[],l=[]},h.abortXHR=function(a){if(a)try{a.abort()}catch(b){this._debug(b)}},h.xhrStatus=function(a){if(a)try{return a.status}catch(b){this._debug(b)}return-1},h},org.cometd.LongPollingTransport=function(){var a=new org.cometd.RequestTransport,b=org.cometd.Transport.derive(a),c=!0;return b.accept=function(a,b){return c||!b},b.xhrSend=function(){throw"Abstract"},b.transportSend=function(a,b){this._debug("Transport",this.getType(),"sending request",b.id,"envelope",a);var d=this;try{var e=!0;b.xhr=this.xhrSend({transport:this,url:a.url,sync:a.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(a.messages),onSuccess:function(e){d._debug("Transport",d.getType(),"received response",e);var f=!1;try{var g=d.convertToMessages(e);0===g.length?(c=!1,d.transportFailure(a,b,{httpCode:204})):(f=!0,d.transportSuccess(a,b,g))}catch(h){if(d._debug(h),!f){c=!1;var i={exception:h};i.httpCode=d.xhrStatus(b.xhr),d.transportFailure(a,b,i)}}},onError:function(f,g){c=!1;var h={reason:f,exception:g};h.httpCode=d.xhrStatus(b.xhr),e?d.setTimeout(function(){d.transportFailure(a,b,h)},0):d.transportFailure(a,b,h)}}),e=!1}catch(f){c=!1,this.setTimeout(function(){d.transportFailure(a,b,{exception:f})},0)}},b.reset=function(){a.reset(),c=!0},b},org.cometd.CallbackPollingTransport=function(){var a=new org.cometd.RequestTransport,b=org.cometd.Transport.derive(a),c=2e3;return b.accept=function(){return!0},b.jsonpSend=function(){throw"Abstract"},b.transportSend=function(a,b){for(var d=this,e=0,f=a.messages.length,g=[];f>0;){var h=org.cometd.JSON.toJSON(a.messages.slice(e,e+f)),i=a.url.length+encodeURI(h).length;if(i>c){if(1===f)return void this.setTimeout(function(){d.transportFailure(a,b,{reason:"Bayeux message too big, max is "+c})},0);--f}else g.push(f),e+=f,f=a.messages.length-e}var j=a;if(g.length>1){var k=0,l=g[0];this._debug("Transport",this.getType(),"split",a.messages.length,"messages into",g.join(" + ")),j=this._mixin(!1,{},a),j.messages=a.messages.slice(k,l),j.onSuccess=a.onSuccess,j.onFailure=a.onFailure;for(var m=1;m<g.length;++m){var n=this._mixin(!1,{},a);k=l,l+=g[m],n.messages=a.messages.slice(k,l),n.onSuccess=a.onSuccess,n.onFailure=a.onFailure,this.send(n,b.metaConnect)}}this._debug("Transport",this.getType(),"sending request",b.id,"envelope",j);try{var o=!0;this.jsonpSend({transport:this,url:j.url,sync:j.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(j.messages),onSuccess:function(a){var c=!1;try{var e=d.convertToMessages(a);0===e.length?d.transportFailure(j,b,{httpCode:204}):(c=!0,d.transportSuccess(j,b,e))}catch(f){d._debug(f),c||d.transportFailure(j,b,{exception:f})}},onError:function(a,c){var e={reason:a,exception:c};o?d.setTimeout(function(){d.transportFailure(j,b,e)},0):d.transportFailure(j,b,e)}}),o=!1}catch(p){this.setTimeout(function(){d.transportFailure(j,b,{exception:p})},0)}},b},org.cometd.WebSocketTransport=function(){function a(){if(!l){l=!0;var a=d.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",a);try{var b=d.getConfiguration().protocol,c=b?new org.cometd.WebSocket(a,b):new org.cometd.WebSocket(a)}catch(e){throw g=!1,this._debug("Exception while creating WebSocket object",e),e}i=d.getConfiguration().stickyReconnect!==!1;var f=this,h=null,j=d.getConfiguration().connectTimeout;j>0&&(h=this.setTimeout(function(){h=null,f._debug("Transport",f.getType(),"timed out while connecting to URL",a,":",j,"ms");var b={code:1e3,reason:"Connect Timeout"};f.webSocketClose(c,b.code,b.reason),f.onClose(c,b)},j));var k=function(){f._debug("WebSocket opened",c),l=!1,h&&(f.clearTimeout(h),h=null),m?(d._warn("Closing Extra WebSocket Connections",c,m),f.webSocketClose(c,1e3,"Extra Connection")):f.onOpen(c)},n=function(a){a=a||{code:1e3},f._debug("WebSocket closing",c,a),l=!1,h&&(f.clearTimeout(h),h=null),null!==m&&c!==m?f._debug("Closed Extra WebSocket Connection",c):f.onClose(c,a)},o=function(a){f._debug("WebSocket message",a,c),c!==m&&d._warn("Extra WebSocket Connections",c,m),f.onMessage(c,a)};c.onopen=k,c.onclose=n,c.onerror=function(){n({code:1002,reason:"Error"})},c.onmessage=o,this._debug("Transport",this.getType(),"configured callbacks on",c)}}function b(a,b,c){var d=org.cometd.JSON.toJSON(b.messages);a.send(d),this._debug("Transport",this.getType(),"sent",b,"metaConnect =",c);var e=this.getConfiguration().maxNetworkDelay,f=e;c&&(f+=this.getAdvice().timeout,n=!0);for(var g=this,h=[],i=0;i<b.messages.length;++i)!function(){var c=b.messages[i];c.id&&(h.push(c.id),k[c.id]=this.setTimeout(function(){g._debug("Transport",g.getType(),"timing out message",c.id,"after",f,"on",a);var b={code:1e3,reason:"Message Timeout"};g.webSocketClose(a,b.code,b.reason),g.onClose(a,b)},f))}();this._debug("Transport",this.getType(),"waiting at most",f,"ms for messages",h,"maxNetworkDelay",e,", timeouts:",k)}function c(c,d,e){try{null===c?a.call(this):b.call(this,c,d,e)}catch(f){this.setTimeout(function(){d.onFailure(c,d.messages,{exception:f})},0)}}var d,e=new org.cometd.Transport,f=org.cometd.Transport.derive(e),g=!0,h=!1,i=!0,j={},k={},l=!1,m=null,n=!1,o=null;return f.reset=function(){e.reset(),g=!0,h=!1,i=!0,j={},k={},l=!1,m=null,n=!1,o=null},f.onOpen=function(a){this._debug("Transport",this.getType(),"opened",a),m=a,h=!0,this._debug("Sending pending messages",j);for(var c in j){var d=j[c],e=d[0],f=d[1];o=e.onSuccess,b.call(this,a,e,f)}},f.onMessage=function(a,b){this._debug("Transport",this.getType(),"received websocket message",b,a);for(var c=!1,d=this.convertToMessages(b.data),e=[],f=0;f<d.length;++f){var g=d[f];if((/^\/meta\//.test(g.channel)||void 0!==g.successful)&&g.id){e.push(g.id);var h=k[g.id];h&&(this.clearTimeout(h),delete k[g.id],this._debug("Transport",this.getType(),"removed timeout for message",g.id,", timeouts",k))}"/meta/connect"===g.channel&&(n=!1),"/meta/disconnect"!==g.channel||n||(c=!0)}for(var i=!1,l=0;l<e.length;++l){var m=e[l];for(var p in j){var q=p.split(","),r=org.cometd.Utils.inArray(m,q);if(r>=0){i=!0,q.splice(r,1);var s=j[p][0],t=j[p][1];delete j[p],q.length>0&&(j[q.join(",")]=[s,t]);break}}}i&&this._debug("Transport",this.getType(),"removed envelope, envelopes",j),o.call(this,d),c&&this.webSocketClose(a,1e3,"Disconnect")},f.onClose=function(a,b){this._debug("Transport",this.getType(),"closed",a,b),g=i&&h;for(var c in k)this.clearTimeout(k[c]);k={};for(var d in j){var e=j[d][0],f=j[d][1];f&&(n=!1),e.onFailure(a,e.messages,{websocketCode:b.code,reason:b.reason})}j={},m=null},f.registered=function(a,b){e.registered(a,b),d=b},f.accept=function(){return g&&!!org.cometd.WebSocket&&d.websocketEnabled!==!1},f.send=function(a,b){this._debug("Transport",this.getType(),"sending",a,"metaConnect =",b);for(var d=[],e=0;e<a.messages.length;++e){var f=a.messages[e];f.id&&d.push(f.id)}j[d.join(",")]=[a,b],this._debug("Transport",this.getType(),"stored envelope, envelopes",j),c.call(this,m,a,b)},f.webSocketClose=function(a,b,c){try{a.close(b,c)}catch(d){this._debug(d)}},f.abort=function(){if(e.abort(),m){var a={code:1001,reason:"Abort"};this.webSocketClose(m,a.code,a.reason),this.onClose(m,a)}this.reset()},f},org.cometd.Cometd=function(a){function b(a,b){try{return a[b]}catch(c){return void 0}}function c(a){return org.cometd.Utils.isString(a)}function d(a){return void 0===a||null===a?!1:"function"==typeof a}function e(a,b){if(window.console){var c=window.console[a];d(c)&&c.apply(window.console,b)}}function f(a){fb._debug("Configuring cometd object with",a),c(a)&&(a={url:a}),a||(a={}),xb=fb._mixin(!1,xb,a);var b=fb.getURL();if(!b)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var d=/(^https?:\/\/)?(((\[[^\]]+\])|([^:\/\?#]+))(:(\d+))?)?([^\?#]*)(.*)?/.exec(b),e=d[2],f=d[8],g=d[9];if(hb=fb._isCrossDomain(e),xb.appendMessageTypeToURL)if(void 0!==g&&g.length>0)fb._info("Appending message type to URI "+f+g+" is not supported, disabling 'appendMessageTypeToURL' configuration"),xb.appendMessageTypeToURL=!1;else{var h=f.split("/"),i=h.length-1;f.match(/\/$/)&&(i-=1),h[i].indexOf(".")>=0&&(fb._info("Appending message type to URI "+f+" is not supported, disabling 'appendMessageTypeToURL' configuration"),xb.appendMessageTypeToURL=!1)}}function g(a){if(a){var b=pb[a.channel];b&&b[a.id]&&(delete b[a.id],fb._debug("Removed",a.listener?"listener":"subscription",a))}}function h(a){a&&!a.listener&&g(a)}function i(){for(var a in pb){var b=pb[a];if(b)for(var c=0;c<b.length;++c)h(b[c])}}function j(a){jb!==a&&(fb._debug("Status",jb,"->",a),jb=a)}function k(){return"disconnecting"===jb||"disconnected"===jb}function l(){return++kb}function m(a,b,c,e,f){try{return b.call(a,e)}catch(g){fb._debug("Exception during execution of extension",c,g);var h=fb.onExtensionException;if(d(h)){fb._debug("Invoking extension exception callback",c,g);try{h.call(fb,g,c,f,e)}catch(i){fb._info("Exception during execution of exception callback in extension",c,i)}}return e}}function n(a){for(var b=0;b<sb.length&&(void 0!==a&&null!==a);++b){var c=xb.reverseIncomingExtensions?sb.length-1-b:b,e=sb[c],f=e.extension.incoming;if(d(f)){var g=m(e.extension,f,e.name,a,!1);a=void 0===g?a:g}}return a}function o(a){for(var b=0;b<sb.length&&(void 0!==a&&null!==a);++b){var c=sb[b],e=c.extension.outgoing;if(d(e)){var f=m(c.extension,e,c.name,a,!0);a=void 0===f?a:f}}return a}function p(a,b){var c=pb[a];if(c&&c.length>0)for(var e=0;e<c.length;++e){var f=c[e];if(f)try{f.callback.call(f.scope,b)}catch(g){fb._debug("Exception during notification",f,b,g);var h=fb.onListenerException;if(d(h)){fb._debug("Invoking listener exception callback",f,g);try{h.call(fb,g,f,f.listener,b)}catch(i){fb._info("Exception during execution of listener callback",f,i)}}}}}function q(a,b){p(a,b);for(var c=a.split("/"),d=c.length-1,e=d;e>0;--e){var f=c.slice(0,e).join("/")+"/*";e===d&&p(f,b),f+="*",p(f,b)}}function r(){null!==rb&&org.cometd.Utils.clearTimeout(rb),rb=null}function s(a){r();var b=tb.interval+qb;fb._debug("Function scheduled in",b,"ms, interval =",tb.interval,"backoff =",qb,a),rb=org.cometd.Utils.setTimeout(fb,a,b)}function t(a,b,c,e){for(var f=0;f<b.length;++f){var g=b[f],h=""+l();g.id=h,lb&&(g.clientId=lb);var i=void 0;d(g._callback)&&(i=g._callback,delete g._callback),g=o(g),void 0!==g&&null!==g?(g.id=h,b[f]=g,i&&(ub[h]=i)):b.splice(f--,1)}if(0!==b.length){var j=fb.getURL();xb.appendMessageTypeToURL&&(j.match(/\/$/)||(j+="/"),e&&(j+=e));var k={url:j,sync:a,messages:b,onSuccess:function(a){try{yb.call(fb,a)}catch(b){fb._debug("Exception during handling of messages",b)}},onFailure:function(a,b,c){try{var d=fb.getTransport();c.connectionType=d?d.getType():"unknown",zb.call(fb,a,b,c)}catch(e){fb._debug("Exception during handling of failure",e)}}};fb._debug("Send",k),cb.send(k,c)}}function u(a){mb>0||ob===!0?nb.push(a):t(!1,[a],!1)}function v(){qb=0}function w(){qb<xb.maxBackoff&&(qb+=xb.backoffIncrement)}function x(){++mb}function y(){var a=nb;nb=[],a.length>0&&t(!1,a,!1)}function z(){if(--mb,0>mb)throw"Calls to startBatch() and endBatch() are not paired";0!==mb||k()||ob||y()}function A(){if(!k()){var a={channel:"/meta/connect",connectionType:cb.getType()};wb||(a.advice={timeout:0}),j("connecting"),fb._debug("Connect sent",a),t(!1,[a],!0,"connect"),j("connected")}}function B(){j("connecting"),s(function(){A()})}function C(a){a&&(tb=fb._mixin(!1,{},xb.advice,a),fb._debug("New advice",tb))}function D(a){if(r(),a&&cb&&cb.abort(),lb=null,j("disconnected"),mb=0,v(),cb=null,nb.length>0){var b=nb;nb=[],zb.call(fb,void 0,b,{reason:"Disconnected"})}}function E(a,b,c){var e=fb.onTransportFailure;if(d(e)){fb._debug("Invoking transport failure callback",a,b,c);try{e.call(fb,a,b,c)}catch(f){fb._info("Exception during execution of transport failure callback",f)}}}function F(a,b){d(a)&&(b=a,a=void 0),lb=null,i(),k()?(ib.reset(),C(xb.advice)):C(fb._mixin(!1,tb,{reconnect:"retry"})),mb=0,ob=!0,db=a,eb=b;var c="1.0",e=fb.getURL(),f=ib.findTransportTypes(c,hb,e),g={version:c,minimumVersion:c,channel:"/meta/handshake",supportedConnectionTypes:f,_callback:b,advice:{timeout:tb.timeout,interval:tb.interval}},h=fb._mixin(!1,{},db,g);if(!cb&&(cb=ib.negotiateTransport(f,c,hb,e),!cb)){var l="Could not find initial transport among: "+ib.getTransportTypes();throw fb._warn(l),l}fb._debug("Initial transport is",cb.getType()),j("handshaking"),fb._debug("Handshake sent",h),t(!1,[h],!1,"handshake")}function G(){j("handshaking"),ob=!0,s(function(){F(db,eb)})}function H(a){var b=ub[a.id];d(b)&&(delete ub[a.id],b.call(fb,a))}function I(a){H(a),q("/meta/handshake",a),q("/meta/unsuccessful",a);var b=!k()&&"none"!==tb.reconnect;b?(w(),G()):D(!1)}function J(a){if(a.successful){lb=a.clientId;var b=fb.getURL(),c=ib.negotiateTransport(a.supportedConnectionTypes,a.version,hb,b);if(null===c){var d="Could not negotiate transport with server; client=["+ib.findTransportTypes(a.version,hb,b)+"], server=["+a.supportedConnectionTypes+"]",e=fb.getTransport();return E(e.getType(),null,{reason:d,connectionType:e.getType(),transport:e}),fb._warn(d),void D(!0)}cb!==c&&(fb._debug("Transport",cb.getType(),"->",c.getType()),cb=c),ob=!1,y(),a.reestablish=vb,vb=!0,H(a),q("/meta/handshake",a);var f=k()?"none":tb.reconnect;switch(f){case"retry":v(),B();break;case"none":D(!1);break;default:throw"Unrecognized advice action "+f}}else I(a)}function K(a){var b="1.0",c=fb.getURL(),d=fb.getTransport(),e=ib.findTransportTypes(b,hb,c),f=ib.negotiateTransport(e,b,hb,c);f?(fb._debug("Transport",d.getType(),"->",f.getType()),E(d.getType(),f.getType(),a.failure),I(a),cb=f):(E(d.getType(),null,a.failure),fb._warn("Could not negotiate transport; client=["+e+"]"),D(!0),I(a))}function L(a){q("/meta/connect",a),q("/meta/unsuccessful",a);var b=k()?"none":tb.reconnect;switch(b){case"retry":B(),w();break;case"handshake":ib.reset(),v(),G();break;case"none":D(!1);break;default:throw"Unrecognized advice action"+b}}function M(a){if(wb=a.successful){q("/meta/connect",a);var b=k()?"none":tb.reconnect;switch(b){case"retry":v(),B();break;case"none":D(!1);break;default:throw"Unrecognized advice action "+b}}else L(a)}function N(a){wb=!1,L(a)}function O(a){D(!0),H(a),q("/meta/disconnect",a),q("/meta/unsuccessful",a)}function P(a){a.successful?(D(!1),H(a),q("/meta/disconnect",a)):O(a)}function Q(a){O(a)}function R(a){var b=pb[a.subscription];if(b)for(var c=b.length-1;c>=0;--c){var d=b[c];if(d&&!d.listener){delete b[c],fb._debug("Removed failed subscription",d);break}}H(a),q("/meta/subscribe",a),q("/meta/unsuccessful",a)}function S(a){a.successful?(H(a),q("/meta/subscribe",a)):R(a)}function T(a){R(a)}function U(a){H(a),q("/meta/unsubscribe",a),q("/meta/unsuccessful",a)}function V(a){a.successful?(H(a),q("/meta/unsubscribe",a)):U(a)}function W(a){U(a)}function X(a){H(a),q("/meta/publish",a),q("/meta/unsuccessful",a)}function Y(a){void 0===a.successful?void 0!==a.data?q(a.channel,a):fb._warn("Unknown Bayeux Message",a):a.successful?(H(a),q("/meta/publish",a)):X(a)}function Z(a){X(a)}function $(a){if(a=n(a),void 0!==a&&null!==a){C(a.advice);var b=a.channel;switch(b){case"/meta/handshake":J(a);break;case"/meta/connect":M(a);break;case"/meta/disconnect":P(a);break;case"/meta/subscribe":S(a);break;case"/meta/unsubscribe":V(a);break;default:Y(a)}}}function _(a){var b=pb[a];if(b)for(var c=0;c<b.length;++c)if(b[c])return!0;return!1}function ab(a,b){var e={scope:a,method:b};if(d(a))e.scope=void 0,e.method=a;else if(c(b)){if(!a)throw"Invalid scope "+a;if(e.method=a[b],!d(e.method))throw"Invalid callback "+b+" for scope "+a}else if(!d(b))throw"Invalid callback "+b;return e}function bb(a,b,c,d){var e=ab(b,c);fb._debug("Adding",d?"listener":"subscription","on",a,"with scope",e.scope,"and callback",e.method);var f={channel:a,scope:e.scope,callback:e.method,listener:d},g=pb[a];return g||(g=[],pb[a]=g),f.id=g.push(f)-1,fb._debug("Added",d?"listener":"subscription",f),f[0]=a,f[1]=f.id,f}var cb,db,eb,fb=this,gb=a||"default",hb=!1,ib=new org.cometd.TransportRegistry,jb="disconnected",kb=0,lb=null,mb=0,nb=[],ob=!1,pb={},qb=0,rb=null,sb=[],tb={},ub={},vb=!1,wb=!1,xb={protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",reverseIncomingExtensions:!0,maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,advice:{timeout:6e4,interval:0,reconnect:"retry"}};this._mixin=function(a,c){for(var d=c||{},e=2;e<arguments.length;++e){var f=arguments[e];if(void 0!==f&&null!==f)for(var g in f){var h=b(f,g),i=b(d,g);if(h!==c&&void 0!==h)if(a&&"object"==typeof h&&null!==h)if(h instanceof Array)d[g]=this._mixin(a,i instanceof Array?i:[],h);else{var j="object"!=typeof i||i instanceof Array?{}:i;d[g]=this._mixin(a,j,h)}else d[g]=h}}return d},this._warn=function(){e("warn",arguments)},this._info=function(){"warn"!==xb.logLevel&&e("info",arguments)},this._debug=function(){"debug"===xb.logLevel&&e("debug",arguments)},this._isCrossDomain=function(a){return a&&a!==window.location.host};var yb,zb;this.send=u,this.receive=$,yb=function(a){fb._debug("Received",a);for(var b=0;b<a.length;++b){var c=a[b];$(c)}},zb=function(a,b,c){fb._debug("handleFailure",a,b,c),c.transport=a;for(var d=0;d<b.length;++d){var e=b[d],f={id:e.id,successful:!1,channel:e.channel,failure:c};switch(c.message=e,e.channel){case"/meta/handshake":K(f);break;case"/meta/connect":N(f);break;case"/meta/disconnect":Q(f);break;case"/meta/subscribe":f.subscription=e.subscription,T(f);break;case"/meta/unsubscribe":f.subscription=e.subscription,W(f);break;default:Z(f)}}},this.registerTransport=function(a,b,c){var e=ib.add(a,b,c);return e&&(this._debug("Registered transport",a),d(b.registered)&&b.registered(a,this)),e},this.getTransportTypes=function(){return ib.getTransportTypes()},this.unregisterTransport=function(a){var b=ib.remove(a);return null!==b&&(this._debug("Unregistered transport",a),d(b.unregistered)&&b.unregistered()),b},this.unregisterTransports=function(){ib.clear()},this.findTransport=function(a){return ib.find(a)},this.configure=function(a){f.call(this,a)},this.init=function(a,b){this.configure(a),this.handshake(b)},this.handshake=function(a,b){j("disconnected"),vb=!1,F(a,b)},this.disconnect=function(a,b,c){if(!k()){"boolean"!=typeof a&&(c=b,b=a,a=!1),d(b)&&(c=b,b=void 0);var e={channel:"/meta/disconnect",_callback:c},f=this._mixin(!1,{},b,e);j("disconnecting"),t(a===!0,[f],!1,"disconnect")}},this.startBatch=function(){x()},this.endBatch=function(){z()},this.batch=function(a,b){var c=ab(a,b);this.startBatch();try{c.method.call(c.scope),this.endBatch()}catch(d){throw this._info("Exception during execution of batch",d),this.endBatch(),d}},this.addListener=function(a,b,d){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!c(a))throw"Illegal argument type: channel must be a string";return bb(a,b,d,!0)},this.removeListener=function(a){if(!(a&&a.channel&&"id"in a))throw"Invalid argument: expected subscription, not "+a;g(a)},this.clearListeners=function(){pb={}},this.subscribe=function(a,b,e,f,g){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!c(a))throw"Illegal argument type: channel must be a string";if(k())throw"Illegal state: already disconnected";d(b)&&(g=f,f=e,e=b,b=void 0),d(f)&&(g=f,f=void 0);var h=!_(a),i=bb(a,b,e,!1);if(h){var j={channel:"/meta/subscribe",subscription:a,_callback:g},l=this._mixin(!1,{},f,j);u(l)}return i},this.unsubscribe=function(a,b,c){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(k())throw"Illegal state: already disconnected";d(b)&&(c=b,b=void 0),this.removeListener(a);var e=a.channel;if(!_(e)){var f={channel:"/meta/unsubscribe",subscription:e,_callback:c},g=this._mixin(!1,{},b,f);u(g)}},this.resubscribe=function(a,b){return h(a),a?this.subscribe(a.channel,a.scope,a.callback,b):void 0},this.clearSubscriptions=function(){i()},this.publish=function(a,b,e,f){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!c(a))throw"Illegal argument type: channel must be a string";if(/^\/meta\//.test(a))throw"Illegal argument: cannot publish to meta channels";if(k())throw"Illegal state: already disconnected";d(b)?(f=b,b=e={}):d(e)&&(f=e,e={});var g={channel:a,data:b,_callback:f},h=this._mixin(!1,{},e,g);u(h)},this.getStatus=function(){return jb},this.isDisconnected=k,this.setBackoffIncrement=function(a){xb.backoffIncrement=a},this.getBackoffIncrement=function(){return xb.backoffIncrement},this.getBackoffPeriod=function(){return qb},this.setLogLevel=function(a){xb.logLevel=a},this.registerExtension=function(a,b){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!c(a))throw"Illegal argument type: extension name must be a string";for(var e=!1,f=0;f<sb.length;++f){var g=sb[f];if(g.name===a){e=!0;break}}return e?(this._info("Could not register extension with name",a,"since another extension with the same name already exists"),!1):(sb.push({name:a,extension:b}),this._debug("Registered extension",a),d(b.registered)&&b.registered(a,this),!0)},this.unregisterExtension=function(a){if(!c(a))throw"Illegal argument type: extension name must be a string";for(var b=!1,e=0;e<sb.length;++e){var f=sb[e];if(f.name===a){sb.splice(e,1),b=!0,this._debug("Unregistered extension",a);var g=f.extension;d(g.unregistered)&&g.unregistered();break}}return b},this.getExtension=function(a){for(var b=0;b<sb.length;++b){var c=sb[b];if(c.name===a)return c.extension}return null},this.getName=function(){return gb},this.getClientId=function(){return lb},this.getURL=function(){if(cb&&"object"==typeof xb.urls){var a=xb.urls[cb.getType()];if(a)return a}return xb.url},this.getTransport=function(){return cb},this.getConfiguration=function(){return this._mixin(!0,{},xb)},this.getAdvice=function(){return this._mixin(!0,{},tb)},org.cometd.WebSocket=window.WebSocket,org.cometd.WebSocket||(org.cometd.WebSocket=window.MozWebSocket)},function(){function a(a,b){function c(a,b){if(b)for(var c in b)"content-type"!==c.toLowerCase()&&a.setRequestHeader(c,b[c])}function d(){var d=new b.LongPollingTransport,e=b.Transport.derive(d);return e.xhrSend=function(b){return a.ajax({url:b.url,async:b.sync!==!0,type:"POST",contentType:"application/json;charset=UTF-8",data:b.body,beforeSend:function(a){return a.withCredentials=!0,c(a,b.headers),!0},success:b.onSuccess,error:function(a,c,d){b.onError(c,d)}})},e}function e(){var d=new b.CallbackPollingTransport,e=b.Transport.derive(d);return e.jsonpSend=function(b){a.ajax({url:b.url,async:b.sync!==!0,type:"GET",dataType:"jsonp",jsonp:"jsonp",data:{message:b.body},beforeSend:function(a){return c(a,b.headers),!0},success:b.onSuccess,error:function(a,c,d){b.onError(c,d)}})},e}return b.JSON.toJSON=JSON.stringify,b.JSON.fromJSON=JSON.parse,a.Cometd=function(a){var c=new b.Cometd(a);return b.WebSocket&&c.registerTransport("websocket",new b.WebSocketTransport),c.registerTransport("long-polling",new d),c.registerTransport("callback-polling",new e),c},a.cometd=new a.Cometd,a.cometd}"function"==typeof define&&define.amd?define(["jquery","org/cometd"],a):a(jQuery,org.cometd)}();
//# sourceMappingURL=epicenter-multiplayer-dependencies.min.js.map