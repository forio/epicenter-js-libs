{"version":3,"sources":["webpack:///login.js","webpack:///webpack/bootstrap 53064a72e6b9f7528bbe","webpack:///./src/components/login/login.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","$","groupSelectionTemplate","showError","msg","text","show","getAccountProjectFromUrl","url","window","location","href","parts","match","account","project","selectGroup","userName","password","groups","action","dlg","length","appendTo","attr","select","find","remove","each","this","groupId","on","e","val","target","removeClass","removeAttr","addClass","closeDlg","hide","off","preventDefault","stopPropagation","form","fromUrl","prop","console","log","auth","F","manager","AuthManager","login","fail","error","status","type","userGroups","statusText","then","session","getCurrentUserSessionInfo","newPage","facPage","isFac","isTeamMember"],"mappings":"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","file":"login.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\n$(function () {\n    'use strict';\n\n    var groupSelectionTemplate;\n\n    var showError = function (msg) {\n        $('#login-message').text(msg).show();\n    };\n\n    var getAccountProjectFromUrl = function () {\n        var url = window.location.href;\n        var parts = url.match(/https?:\\/\\/([^/]*)\\/app\\/([^/]*)\\/([^/]*)/) || [];\n        return {\n            account: parts[2],\n            project: parts[3], //eslint-disable-line\n        };\n    };\n\n    var selectGroup = function (userName, password, account, project, groups, action) {\n        var dlg = (dlg = $('.group-selection-dialog')).length ? dlg : $(groupSelectionTemplate).appendTo($('body')); //eslint-disable-line\n        dlg.attr('action', action);\n        var select = $('#login-group', dlg);\n        select.find('[value!=\"\"]').remove();\n        $.each(groups, function () {\n            $('<option>')\n                .attr('value', this.groupId)\n                .text(this.name)\n                .appendTo(select);\n        });\n\n        select.on('change', function (e) {\n            var val = $(e.target).val();\n            $('#groupId').val(val);\n\n            if (val) {\n                $('#btn-login', dlg).removeClass('disabled').removeAttr('disabled');\n            } else {\n                $('#btn-login', dlg).addClass('disabled').attr('disabled', 'disabled');\n            }\n        });\n\n        var closeDlg = function () {\n            $('.group-selection-dialog').hide();\n        };\n\n        $('.close', dlg).off('click', null).on('click', closeDlg);\n\n        $('.group-selection-dialog').show();\n    };\n\n    $('body').on('submit', '#login, form:has(#btn-login)', function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        var form = $(e.target);\n        var fromUrl = getAccountProjectFromUrl();\n        var action = form.prop('action') || 'index.html';\n        var userName = $('#username').val();\n        var password = $('#password').val();\n        var account = $('#account').val() || fromUrl.account;\n        var project = $('#project').val() || fromUrl.project;\n        var groupId = ($('#groupId').length ? $('#groupId') : $('<input type=\"hidden\" id=\"groupId\">').appendTo(form)).val();\n\n        $('button', form).attr('disabled', 'disabled').addClass('disabled');\n        $('#login-message').text('').hide();\n\n        if (!account) {\n            console.log('No account was specified and it cannot be extracted from the URL. You may not be able to login.');\n        }\n\n        if (!project) {\n            console.log('No project was specified and it cannot be extracted from the URL.');\n        }\n\n        var auth = new F.manager.AuthManager();\n        auth.login({\n            userName: userName,\n            password: password,\n            account: account,\n            project: project,\n            groupId: groupId\n        })\n            .fail(function (error) {\n                if (error.status === 401) {\n                    showError('Invalid user name or password.', error.status);\n                } else if (error.status === 403) {\n                    if (error.type === 'MULTIPLE_GROUPS') {\n                        selectGroup(userName, password, account, project, error.userGroups, action);\n                    } else if (error.type === 'NO_GROUPS') {\n                        showError('The user has no groups associated in this account');\n                    } else {\n                        showError(error.statusText || ('Unknown Error' + error.status));\n                    }\n                } else {\n                    showError('Unknown error occured. Please try again. (' + error.status + ')');\n                }\n\n                $('button', form).attr('disabled', null).removeClass('disabled');\n            })\n            .then(function () {\n                // var pageToRedirectTo = action;\n                // fac-redirect-page\n                var session = auth.getCurrentUserSessionInfo();\n                var newPage = action;\n                var facPage = $('#fac-redirect-page').val();\n                if ((session.isFac || session.isTeamMember) && facPage) {\n                    newPage = facPage;\n                }\n                window.location = newPage;\n                $('.group-selection-dialog').hide();\n            });\n    });\n\n    groupSelectionTemplate = window.groupSelectionTemplate = '<form>\\\n        <div class=\"group-selection-dialog\" style=\"display: none\"> \\\n            <div class=\"panel panel-default form-inline\"> \\\n                <div class=\"panel-heading\"><span class=\"panel-title\">Please select a group</span><span class=\"close pull-right\"></span></div> \\\n                <div class=\"panel-body\"> \\\n                    <label for=\"login-group\">Group:</label> \\\n                    <select name=\"login-group\" id=\"login-group\" class=\"form-control\"> \\\n                        <option default value=\"\">Please select a group</option> \\\n                    </select> \\\n                </div> \\\n                <div class=\"panel-footer clearfix\"> \\\n                    <button id=\"btn-login\" disabled class=\"pull-right btn btn-primary disabled\">Select Group</button> \\\n                </div> \\\n            </div> \\\n        </div> \\\n    </form> \\\n    ';\n});\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// login.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 53064a72e6b9f7528bbe","$(function () {\n    'use strict';\n\n    var groupSelectionTemplate;\n\n    var showError = function (msg) {\n        $('#login-message').text(msg).show();\n    };\n\n    var getAccountProjectFromUrl = function () {\n        var url = window.location.href;\n        var parts = url.match(/https?:\\/\\/([^/]*)\\/app\\/([^/]*)\\/([^/]*)/) || [];\n        return {\n            account: parts[2],\n            project: parts[3], //eslint-disable-line\n        };\n    };\n\n    var selectGroup = function (userName, password, account, project, groups, action) {\n        var dlg = (dlg = $('.group-selection-dialog')).length ? dlg : $(groupSelectionTemplate).appendTo($('body')); //eslint-disable-line\n        dlg.attr('action', action);\n        var select = $('#login-group', dlg);\n        select.find('[value!=\"\"]').remove();\n        $.each(groups, function () {\n            $('<option>')\n                .attr('value', this.groupId)\n                .text(this.name)\n                .appendTo(select);\n        });\n\n        select.on('change', function (e) {\n            var val = $(e.target).val();\n            $('#groupId').val(val);\n\n            if (val) {\n                $('#btn-login', dlg).removeClass('disabled').removeAttr('disabled');\n            } else {\n                $('#btn-login', dlg).addClass('disabled').attr('disabled', 'disabled');\n            }\n        });\n\n        var closeDlg = function () {\n            $('.group-selection-dialog').hide();\n        };\n\n        $('.close', dlg).off('click', null).on('click', closeDlg);\n\n        $('.group-selection-dialog').show();\n    };\n\n    $('body').on('submit', '#login, form:has(#btn-login)', function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        var form = $(e.target);\n        var fromUrl = getAccountProjectFromUrl();\n        var action = form.prop('action') || 'index.html';\n        var userName = $('#username').val();\n        var password = $('#password').val();\n        var account = $('#account').val() || fromUrl.account;\n        var project = $('#project').val() || fromUrl.project;\n        var groupId = ($('#groupId').length ? $('#groupId') : $('<input type=\"hidden\" id=\"groupId\">').appendTo(form)).val();\n\n        $('button', form).attr('disabled', 'disabled').addClass('disabled');\n        $('#login-message').text('').hide();\n\n        if (!account) {\n            console.log('No account was specified and it cannot be extracted from the URL. You may not be able to login.');\n        }\n\n        if (!project) {\n            console.log('No project was specified and it cannot be extracted from the URL.');\n        }\n\n        var auth = new F.manager.AuthManager();\n        auth.login({\n            userName: userName,\n            password: password,\n            account: account,\n            project: project,\n            groupId: groupId\n        })\n            .fail(function (error) {\n                if (error.status === 401) {\n                    showError('Invalid user name or password.', error.status);\n                } else if (error.status === 403) {\n                    if (error.type === 'MULTIPLE_GROUPS') {\n                        selectGroup(userName, password, account, project, error.userGroups, action);\n                    } else if (error.type === 'NO_GROUPS') {\n                        showError('The user has no groups associated in this account');\n                    } else {\n                        showError(error.statusText || ('Unknown Error' + error.status));\n                    }\n                } else {\n                    showError('Unknown error occured. Please try again. (' + error.status + ')');\n                }\n\n                $('button', form).attr('disabled', null).removeClass('disabled');\n            })\n            .then(function () {\n                // var pageToRedirectTo = action;\n                // fac-redirect-page\n                var session = auth.getCurrentUserSessionInfo();\n                var newPage = action;\n                var facPage = $('#fac-redirect-page').val();\n                if ((session.isFac || session.isTeamMember) && facPage) {\n                    newPage = facPage;\n                }\n                window.location = newPage;\n                $('.group-selection-dialog').hide();\n            });\n    });\n\n    groupSelectionTemplate = window.groupSelectionTemplate = '<form>\\\n        <div class=\"group-selection-dialog\" style=\"display: none\"> \\\n            <div class=\"panel panel-default form-inline\"> \\\n                <div class=\"panel-heading\"><span class=\"panel-title\">Please select a group</span><span class=\"close pull-right\"></span></div> \\\n                <div class=\"panel-body\"> \\\n                    <label for=\"login-group\">Group:</label> \\\n                    <select name=\"login-group\" id=\"login-group\" class=\"form-control\"> \\\n                        <option default value=\"\">Please select a group</option> \\\n                    </select> \\\n                </div> \\\n                <div class=\"panel-footer clearfix\"> \\\n                    <button id=\"btn-login\" disabled class=\"pull-right btn btn-primary disabled\">Select Group</button> \\\n                </div> \\\n            </div> \\\n        </div> \\\n    </form> \\\n    ';\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/login/login.js\n// module id = 0\n// module chunks = 0"],"sourceRoot":""}