(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function Buffer(t,e,r){if(!(this instanceof Buffer))return new Buffer(t,e,r);var n,i=typeof t;if("number"===i)n=+t;else if("string"===i)n=Buffer.byteLength(t,e);else{if("object"!==i||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&isArray(t.data)&&(t=t.data),n=+t.length}if(n>kMaxLength)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength.toString(16)+" bytes");0>n?n=0:n>>>=0;var f=this;Buffer.TYPED_ARRAY_SUPPORT?f=Buffer._augment(new Uint8Array(n)):(f.length=n,f._isBuffer=!0);var o;if(Buffer.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)f._set(t);else if(isArrayish(t))if(Buffer.isBuffer(t))for(o=0;n>o;o++)f[o]=t.readUInt8(o);else for(o=0;n>o;o++)f[o]=(t[o]%256+256)%256;else if("string"===i)f.write(t,0,e);else if("number"===i&&!Buffer.TYPED_ARRAY_SUPPORT&&!r)for(o=0;n>o;o++)f[o]=0;return n>0&&n<=Buffer.poolSize&&(f.parent=rootParent),f}function SlowBuffer(t,e,r){if(!(this instanceof SlowBuffer))return new SlowBuffer(t,e,r);var n=new Buffer(t,e,r);return delete n.parent,n}function hexWrite(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var f=e.length;if(f%2!==0)throw new Error("Invalid hex string");n>f/2&&(n=f/2);for(var o=0;n>o;o++){var u=parseInt(e.substr(2*o,2),16);if(isNaN(u))throw new Error("Invalid hex string");t[r+o]=u}return o}function utf8Write(t,e,r,n){var i=blitBuffer(utf8ToBytes(e,t.length-r),t,r,n);return i}function asciiWrite(t,e,r,n){var i=blitBuffer(asciiToBytes(e),t,r,n);return i}function binaryWrite(t,e,r,n){return asciiWrite(t,e,r,n)}function base64Write(t,e,r,n){var i=blitBuffer(base64ToBytes(e),t,r,n);return i}function utf16leWrite(t,e,r,n){var i=blitBuffer(utf16leToBytes(e,t.length-r),t,r,n,2);return i}function base64Slice(t,e,r){return base64.fromByteArray(0===e&&r===t.length?t:t.slice(e,r))}function utf8Slice(t,e,r){var n="",i="";r=Math.min(t.length,r);for(var f=e;r>f;f++)t[f]<=127?(n+=decodeUtf8Char(i)+String.fromCharCode(t[f]),i=""):i+="%"+t[f].toString(16);return n+decodeUtf8Char(i)}function asciiSlice(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(127&t[i]);return n}function binarySlice(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(t[i]);return n}function hexSlice(t,e,r){var n=t.length;(!e||0>e)&&(e=0),(!r||0>r||r>n)&&(r=n);for(var i="",f=e;r>f;f++)i+=toHex(t[f]);return i}function utf16leSlice(t,e,r){for(var n=t.slice(e,r),i="",f=0;f<n.length;f+=2)i+=String.fromCharCode(n[f]+256*n[f+1]);return i}function checkOffset(t,e,r){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(t,e,r,n,i,f){if(!Buffer.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>i||f>e)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range")}function objectWriteUInt16(t,e,r,n){0>e&&(e=65535+e+1);for(var i=0,f=Math.min(t.length-r,2);f>i;i++)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function objectWriteUInt32(t,e,r,n){0>e&&(e=4294967295+e+1);for(var i=0,f=Math.min(t.length-r,4);f>i;i++)t[r+i]=e>>>8*(n?i:3-i)&255}function checkIEEE754(t,e,r,n,i,f){if(e>i||f>e)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range");if(0>r)throw new RangeError("index out of range")}function writeFloat(t,e,r,n,i){return i||checkIEEE754(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(t,e,r,n,23,4),r+4}function writeDouble(t,e,r,n,i){return i||checkIEEE754(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(t,e,r,n,52,8),r+8}function base64clean(t){if(t=stringtrim(t).replace(INVALID_BASE64_RE,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function stringtrim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function isArrayish(t){return isArray(t)||Buffer.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function toHex(t){return 16>t?"0"+t.toString(16):t.toString(16)}function utf8ToBytes(t,e){e=e||1/0;for(var r,n=t.length,i=null,f=[],o=0;n>o;o++){if(r=t.charCodeAt(o),r>55295&&57344>r){if(!i){if(r>56319){(e-=3)>-1&&f.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&f.push(239,191,189);continue}i=r;continue}if(56320>r){(e-=3)>-1&&f.push(239,191,189),i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&((e-=3)>-1&&f.push(239,191,189),i=null);if(128>r){if((e-=1)<0)break;f.push(r)}else if(2048>r){if((e-=2)<0)break;f.push(r>>6|192,63&r|128)}else if(65536>r){if((e-=3)<0)break;f.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(2097152>r))throw new Error("Invalid code point");if((e-=4)<0)break;f.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return f}function asciiToBytes(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e}function utf16leToBytes(t,e){for(var r,n,i,f=[],o=0;o<t.length&&!((e-=2)<0);o++)r=t.charCodeAt(o),n=r>>8,i=r%256,f.push(i),f.push(n);return f}function base64ToBytes(t){return base64.toByteArray(base64clean(t))}function blitBuffer(t,e,r,n,i){i&&(n-=n%i);for(var f=0;n>f&&!(f+r>=e.length||f>=t.length);f++)e[f+r]=t[f];return f}function decodeUtf8Char(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("is-array");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.poolSize=8192;var kMaxLength=1073741823,rootParent={};Buffer.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(r){return!1}}(),Buffer.isBuffer=function(t){return!(null==t||!t._isBuffer)},Buffer.compare=function(t,e){if(!Buffer.isBuffer(t)||!Buffer.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,f=Math.min(r,n);f>i&&t[i]===e[i];i++);return i!==f&&(r=t[i],n=e[i]),n>r?-1:r>n?1:0},Buffer.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(t,e){if(!isArray(t))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===t.length)return new Buffer(0);if(1===t.length)return t[0];var r;if(void 0===e)for(e=0,r=0;r<t.length;r++)e+=t[r].length;var n=new Buffer(e),i=0;for(r=0;r<t.length;r++){var f=t[r];f.copy(n,i),i+=f.length}return n},Buffer.byteLength=function(t,e){var r;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":r=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*t.length;break;case"hex":r=t.length>>>1;break;case"utf8":case"utf-8":r=utf8ToBytes(t).length;break;case"base64":r=base64ToBytes(t).length;break;default:r=t.length}return r},Buffer.prototype.length=void 0,Buffer.prototype.parent=void 0,Buffer.prototype.toString=function(t,e,r){var n=!1;if(e>>>=0,r=void 0===r||1/0===r?this.length:r>>>0,t||(t="utf8"),0>e&&(e=0),r>this.length&&(r=this.length),e>=r)return"";for(;;)switch(t){case"hex":return hexSlice(this,e,r);case"utf8":case"utf-8":return utf8Slice(this,e,r);case"ascii":return asciiSlice(this,e,r);case"binary":return binarySlice(this,e,r);case"base64":return base64Slice(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}},Buffer.prototype.equals=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===Buffer.compare(this,t)},Buffer.prototype.inspect=function(){var t="",e=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},Buffer.prototype.compare=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:Buffer.compare(this,t)},Buffer.prototype.get=function(t){return this.readUInt8(t)},Buffer.prototype.set=function(t,e){return this.writeUInt8(t,e)},Buffer.prototype.write=function(t,e,r,n){if(isFinite(e))isFinite(r)||(n=r,r=void 0);else{var i=n;n=e,e=r,r=i}if(e=Number(e)||0,0>r||0>e||e>this.length)throw new RangeError("attempt to write outside buffer bounds");var f=this.length-e;r?(r=Number(r),r>f&&(r=f)):r=f,n=String(n||"utf8").toLowerCase();var o;switch(n){case"hex":o=hexWrite(this,t,e,r);break;case"utf8":case"utf-8":o=utf8Write(this,t,e,r);break;case"ascii":o=asciiWrite(this,t,e,r);break;case"binary":o=binaryWrite(this,t,e,r);break;case"base64":o=base64Write(this,t,e,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":o=utf16leWrite(this,t,e,r);break;default:throw new TypeError("Unknown encoding: "+n)}return o},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),t>e&&(e=t);var n;if(Buffer.TYPED_ARRAY_SUPPORT)n=Buffer._augment(this.subarray(t,e));else{var i=e-t;n=new Buffer(i,void 0,!0);for(var f=0;i>f;f++)n[f]=this[f+t]}return n.length&&(n.parent=this.parent||this),n},Buffer.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||checkOffset(t,e,this.length);for(var n=this[t],i=1,f=0;++f<e&&(i*=256);)n+=this[t+f]*i;return n},Buffer.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||checkOffset(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},Buffer.prototype.readUInt8=function(t,e){return e||checkOffset(t,1,this.length),this[t]},Buffer.prototype.readUInt16LE=function(t,e){return e||checkOffset(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUInt16BE=function(t,e){return e||checkOffset(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUInt32LE=function(t,e){return e||checkOffset(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUInt32BE=function(t,e){return e||checkOffset(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||checkOffset(t,e,this.length);for(var n=this[t],i=1,f=0;++f<e&&(i*=256);)n+=this[t+f]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},Buffer.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||checkOffset(t,e,this.length);for(var n=e,i=1,f=this[t+--n];n>0&&(i*=256);)f+=this[t+--n]*i;return i*=128,f>=i&&(f-=Math.pow(2,8*e)),f},Buffer.prototype.readInt8=function(t,e){return e||checkOffset(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Buffer.prototype.readInt16LE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(t,e){return e||checkOffset(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function(t,e){return e||checkOffset(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readFloatLE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!1,52,8)},Buffer.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||checkInt(this,t,e,r,Math.pow(2,8*r),0);var i=1,f=0;for(this[e]=255&t;++f<r&&(i*=256);)this[e+f]=t/i>>>0&255;return e+r},Buffer.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||checkInt(this,t,e,r,Math.pow(2,8*r),0);var i=r-1,f=1;for(this[e+i]=255&t;--i>=0&&(f*=256);)this[e+i]=t/f>>>0&255;return e+r},Buffer.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},Buffer.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeIntLE=function(t,e,r,n){t=+t,e>>>=0,n||checkInt(this,t,e,r,Math.pow(2,8*r-1)-1,-Math.pow(2,8*r-1));var i=0,f=1,o=0>t?1:0;for(this[e]=255&t;++i<r&&(f*=256);)this[e+i]=(t/f>>0)-o&255;return e+r},Buffer.prototype.writeIntBE=function(t,e,r,n){t=+t,e>>>=0,n||checkInt(this,t,e,r,Math.pow(2,8*r-1)-1,-Math.pow(2,8*r-1));var i=r-1,f=1,o=0>t?1:0;for(this[e+i]=255&t;--i>=0&&(f*=256);)this[e+i]=(t/f>>0)-o&255;return e+r},Buffer.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=t,e+1},Buffer.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeFloatLE=function(t,e,r){return writeFloat(this,t,e,!0,r)},Buffer.prototype.writeFloatBE=function(t,e,r){return writeFloat(this,t,e,!1,r)},Buffer.prototype.writeDoubleLE=function(t,e,r){return writeDouble(this,t,e,!0,r)},Buffer.prototype.writeDoubleBE=function(t,e,r){return writeDouble(this,t,e,!1,r)},Buffer.prototype.copy=function(t,e,r,n){var i=this;if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&r>n&&(n=r),n===r)return 0;if(0===t.length||0===i.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>r||r>=i.length)throw new RangeError("sourceStart out of bounds");if(0>n)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var f=n-r;if(1e3>f||!Buffer.TYPED_ARRAY_SUPPORT)for(var o=0;f>o;o++)t[o+e]=this[o+r];else t._set(this.subarray(r,r+f),e);return f},Buffer.prototype.fill=function(t,e,r){if(t||(t=0),e||(e=0),r||(r=this.length),e>r)throw new RangeError("end < start");if(r!==e&&0!==this.length){if(0>e||e>=this.length)throw new RangeError("start out of bounds");if(0>r||r>this.length)throw new RangeError("end out of bounds");var n;if("number"==typeof t)for(n=e;r>n;n++)this[n]=t;else{var i=utf8ToBytes(t.toString()),f=i.length;for(n=e;r>n;n++)this[n]=i[n%f]}return this}},Buffer.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Buffer.TYPED_ARRAY_SUPPORT)return new Buffer(this).buffer;for(var t=new Uint8Array(this.length),e=0,r=t.length;r>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var BP=Buffer.prototype;Buffer._augment=function(t){return t.constructor=Buffer,t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=BP.get,t.set=BP.set,t.write=BP.write,t.toString=BP.toString,t.toLocaleString=BP.toString,t.toJSON=BP.toJSON,t.equals=BP.equals,t.compare=BP.compare,t.copy=BP.copy,t.slice=BP.slice,t.readUIntLE=BP.readUIntLE,t.readUIntBE=BP.readUIntBE,t.readUInt8=BP.readUInt8,t.readUInt16LE=BP.readUInt16LE,t.readUInt16BE=BP.readUInt16BE,t.readUInt32LE=BP.readUInt32LE,t.readUInt32BE=BP.readUInt32BE,t.readIntLE=BP.readIntLE,t.readIntBE=BP.readIntBE,t.readInt8=BP.readInt8,t.readInt16LE=BP.readInt16LE,t.readInt16BE=BP.readInt16BE,t.readInt32LE=BP.readInt32LE,t.readInt32BE=BP.readInt32BE,t.readFloatLE=BP.readFloatLE,t.readFloatBE=BP.readFloatBE,t.readDoubleLE=BP.readDoubleLE,t.readDoubleBE=BP.readDoubleBE,t.writeUInt8=BP.writeUInt8,t.writeUIntLE=BP.writeUIntLE,t.writeUIntBE=BP.writeUIntBE,t.writeUInt16LE=BP.writeUInt16LE,t.writeUInt16BE=BP.writeUInt16BE,t.writeUInt32LE=BP.writeUInt32LE,t.writeUInt32BE=BP.writeUInt32BE,t.writeIntLE=BP.writeIntLE,t.writeIntBE=BP.writeIntBE,t.writeInt8=BP.writeInt8,t.writeInt16LE=BP.writeInt16LE,t.writeInt16BE=BP.writeInt16BE,t.writeInt32LE=BP.writeInt32LE,t.writeInt32BE=BP.writeInt32BE,t.writeFloatLE=BP.writeFloatLE,t.writeFloatBE=BP.writeFloatBE,t.writeDoubleLE=BP.writeDoubleLE,t.writeDoubleBE=BP.writeDoubleBE,t.fill=BP.fill,t.inspect=BP.inspect,t.toArrayBuffer=BP.toArrayBuffer,t};var INVALID_BASE64_RE=/[^+\/0-9A-z\-]/g;
},{"base64-js":2,"ieee754":3,"is-array":4}],2:[function(require,module,exports){
var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function r(t){var r=t.charCodeAt(0);return r===h||r===u?62:r===c||r===f?63:o>r?-1:o+10>r?r-o+26+26:i+26>r?r-i:A+26>r?r-A+26:void 0}function e(t){function e(t){i[f++]=t}var n,h,c,o,A,i;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=t.length;A="="===t.charAt(u-2)?2:"="===t.charAt(u-1)?1:0,i=new a(3*t.length/4-A),c=A>0?t.length-4:t.length;var f=0;for(n=0,h=0;c>n;n+=4,h+=3)o=r(t.charAt(n))<<18|r(t.charAt(n+1))<<12|r(t.charAt(n+2))<<6|r(t.charAt(n+3)),e((16711680&o)>>16),e((65280&o)>>8),e(255&o);return 2===A?(o=r(t.charAt(n))<<2|r(t.charAt(n+1))>>4,e(255&o)):1===A&&(o=r(t.charAt(n))<<10|r(t.charAt(n+1))<<4|r(t.charAt(n+2))>>2,e(o>>8&255),e(255&o)),i}function n(t){function r(t){return lookup.charAt(t)}function e(t){return r(t>>18&63)+r(t>>12&63)+r(t>>6&63)+r(63&t)}var n,a,h,c=t.length%3,o="";for(n=0,h=t.length-c;h>n;n+=3)a=(t[n]<<16)+(t[n+1]<<8)+t[n+2],o+=e(a);switch(c){case 1:a=t[t.length-1],o+=r(a>>2),o+=r(a<<4&63),o+="==";break;case 2:a=(t[t.length-2]<<8)+t[t.length-1],o+=r(a>>10),o+=r(a>>4&63),o+=r(a<<2&63),o+="="}return o}var a="undefined"!=typeof Uint8Array?Uint8Array:Array,h="+".charCodeAt(0),c="/".charCodeAt(0),o="0".charCodeAt(0),A="a".charCodeAt(0),i="A".charCodeAt(0),u="-".charCodeAt(0),f="_".charCodeAt(0);t.toByteArray=e,t.fromByteArray=n}("undefined"==typeof exports?this.base64js={}:exports);
},{}],3:[function(require,module,exports){
exports.read=function(o,t,a,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,n=a?h-1:0,s=a?-1:1,N=o[t+n];for(n+=s,M=N&(1<<-i)-1,N>>=-i,i+=w;i>0;M=256*M+o[t+n],n+=s,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+o[t+n],n+=s,i-=8);if(0===M)M=1-e;else{if(M===f)return p?0/0:1/0*(N?-1:1);p+=Math.pow(2,r),M-=e}return(N?-1:1)*p*Math.pow(2,M-r)},exports.write=function(o,t,a,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,n=i>>1,s=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,N=r?0:M-1,u=r?1:-1,l=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(w=isNaN(t)?1:0,p=i):(p=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-p))<1&&(p--,f*=2),t+=p+n>=1?s/f:s*Math.pow(2,1-n),t*f>=2&&(p++,f/=2),p+n>=i?(w=0,p=i):p+n>=1?(w=(t*f-1)*Math.pow(2,h),p+=n):(w=t*Math.pow(2,n-1)*Math.pow(2,h),p=0));h>=8;o[a+N]=255&w,N+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;o[a+N]=255&p,N+=u,p/=256,e-=8);o[a+N-u]|=128*l};
},{}],4:[function(require,module,exports){
var isArray=Array.isArray,str=Object.prototype.toString;module.exports=isArray||function(r){return!!r&&"[object Array]"==str.call(r)};
},{}],5:[function(require,module,exports){
var F={util:{},factory:{},transport:{},store:{},service:{},manager:{strategy:{}}};F.util.query=require("./util/query-util"),F.util.makeSequence=require("./util/make-sequence"),F.util.run=require("./util/run-util"),F.util.classFrom=require("./util/inherit"),F.factory.Transport=require("./transport/http-transport-factory"),F.transport.Ajax=require("./transport/ajax-http-transport"),F.service.URL=require("./service/url-config-service"),F.service.Config=require("./service/configuration-service"),F.service.Run=require("./service/run-api-service"),F.service.Variables=require("./service/variables-api-service"),F.service.Data=require("./service/data-api-service"),F.service.Auth=require("./service/auth-api-service"),F.service.World=require("./service/world-api-adapter"),F.store.Cookie=require("./store/cookie-store"),F.factory.Store=require("./store/store-factory"),F.manager.ScenarioManager=require("./managers/scenario-manager"),F.manager.RunManager=require("./managers/run-manager"),F.manager.AuthManager=require("./managers/auth-manager"),F.manager.WorldManager=require("./managers/world-manager"),F.manager.strategy["always-new"]=require("./managers/run-strategies/always-new-strategy"),F.manager.strategy["conditional-creation"]=require("./managers/run-strategies/conditional-creation-strategy"),F.manager.strategy.identity=require("./managers/run-strategies/identity-strategy"),F.manager.strategy["new-if-missing"]=require("./managers/run-strategies/new-if-missing-strategy"),F.manager.strategy["new-if-missing"]=require("./managers/run-strategies/new-if-missing-strategy"),F.manager.strategy["new-if-persisted"]=require("./managers/run-strategies/new-if-persisted-strategy"),F.manager.strategy["new-if-initialized"]=require("./managers/run-strategies/new-if-initialized-strategy"),F.manager.ChannelManager=require("./managers/epicenter-channel-manager"),F.service.Channel=require("./service/channel-service"),F.version="1.4.0",window.F=F;
},{"./managers/auth-manager":6,"./managers/epicenter-channel-manager":8,"./managers/run-manager":10,"./managers/run-strategies/always-new-strategy":11,"./managers/run-strategies/conditional-creation-strategy":12,"./managers/run-strategies/identity-strategy":13,"./managers/run-strategies/new-if-initialized-strategy":15,"./managers/run-strategies/new-if-missing-strategy":16,"./managers/run-strategies/new-if-persisted-strategy":17,"./managers/scenario-manager":20,"./managers/world-manager":22,"./service/auth-api-service":23,"./service/channel-service":24,"./service/configuration-service":25,"./service/data-api-service":26,"./service/run-api-service":28,"./service/url-config-service":30,"./service/variables-api-service":31,"./service/world-api-adapter":32,"./store/cookie-store":33,"./store/store-factory":34,"./transport/ajax-http-transport":35,"./transport/http-transport-factory":36,"./util/inherit":37,"./util/make-sequence":38,"./util/query-util":40,"./util/run-util":41}],6:[function(require,module,exports){
"use strict";function saveSession(e){var t=JSON.stringify(e);store.set(EPI_SESSION_KEY,t),store.set(EPI_COOKIE_KEY,e.auth_token)}function getSession(){var e=store.get(EPI_SESSION_KEY)||"{}";return JSON.parse(e)}function AuthManager(e){this.options=$.extend(!0,{},defaults,e),this.authAdapter=new AuthAdapter(this.options),this.memberAdapter=new MemberAdapter(this.options);var t=new ConfigService(this.options).get("server");this.options.account||(this.options.account=t.accountPath),void 0===this.options.project&&(this.options.project=t.projectPath),store=new StorageFactory(this.options.store),token=store.get(EPI_COOKIE_KEY)||""}var ConfigService=require("../service/configuration-service"),AuthAdapter=require("../service/auth-api-service"),MemberAdapter=require("../service/member-api-adapter"),StorageFactory=require("../store/store-factory"),Buffer=require("buffer").Buffer,keyNames=require("./key-names"),defaults={store:{synchronous:!0}},EPI_COOKIE_KEY=keyNames.EPI_COOKIE_KEY,EPI_SESSION_KEY=keyNames.EPI_SESSION_KEY,store,token,_findUserInGroup=function(e,t){for(var r=0;r<e.length;r++)if(e[r].userId===t)return e[r];return null};AuthManager.prototype=$.extend(AuthManager.prototype,{login:function(e){var t=this,r=$.Deferred(),o=$.extend(!0,{success:$.noop,error:$.noop},this.options,e),s=o.success,n=o.error,i=o.groupId,u=function(e){for(var t=e.split(".")[1];t.length%4!==0;)t+="=";var r=window.atob?window.atob:function(e){return new Buffer(e,"base64").toString("ascii")};return JSON.parse(r(t))},a=function(e,o,s){t.logout().then(function(){var t=$.extend(!0,{},s,{statusText:e,status:o});r.reject(t)})},c=function(e){token=e.access_token;var n=u(token),c=$.extend(!0,{},o,{userId:n.user_id,success:$.noop});t.getUserGroups(c).done(function(t){var u={auth:e,user:n,userGroups:t,groupSelection:{}},c={auth_token:token,account:o.account,project:o.project,userId:n.user_id};if(!o.project)return saveSession(c),s.apply(this,[u]),void r.resolve(u);var p=null;if(0===t.length)return void a("The user has no groups associated in this account",401,u);if(1===t.length)p=t[0];else if(t.length>1&&i){var h=$.grep(t,function(e){return e.groupId===i});p=1===h.length?h[0]:null}if(p){var f=p.groupId;u.groupSelection[o.project]=f;var d=$.extend({},c,{groupId:p.groupId,groupName:p.name,isFac:"facilitator"===_findUserInGroup(p.members,n.user_id).role});saveSession(d),s.apply(this,[u]),r.resolve(u)}else a("This account is associated with more that one group. Please specify a group id to log into and try again",403,u)}).fail(r.reject)};return o.success=c,o.error=function(e){return o.account?(o.account=null,o.error=function(){n.apply(this,arguments),r.reject(e)},void t.authAdapter.login(o)):(n.apply(this,arguments),void r.reject(e))},this.authAdapter.login(o),r.promise()},logout:function(e){var t=$.Deferred(),r=$.extend(!0,{success:$.noop,token:token},this.options,e),o=function(){store.remove(EPI_COOKIE_KEY,r),store.remove(EPI_SESSION_KEY,r),token=""},s=r.success;return r.success=function(e){o(e),s.apply(this,arguments)},r.error=function(e){o(e),s.apply(this,arguments),t.resolve()},this.authAdapter.logout(r).done(t.resolve),t.promise()},getToken:function(e){var t=$.extend(!0,this.options,e),r=$.Deferred();return token?r.resolve(token):this.login(t).then(r.resolve),r.promise()},getUserGroups:function(e){var t=$.extend(!0,{success:$.noop},this.options,e),r=$.Deferred(),o=t.success;return t.success=function(e){t.project&&(e=$.grep(e,function(e){return e.project===t.project})),o.apply(this,[e]),r.resolve(e)},this.memberAdapter.getGroupsByUser(t).fail(r.reject),r.promise()},getCurrentUserSessionInfo:function(e){return getSession(e)}}),module.exports=AuthManager;
},{"../service/auth-api-service":23,"../service/configuration-service":25,"../service/member-api-adapter":27,"../store/store-factory":34,"./key-names":9,"buffer":1}],7:[function(require,module,exports){
"use strict";var Channel=require("../service/channel-service"),ChannelManager=function(e){if(!$.cometd)throw new Error("Cometd library not found. Please include epicenter-multiplayer-dependencies.js");if(!e||!e.url)throw new Error("Please provide an url for the cometd server");var n=new $.Cometd,t={url:"",logLevel:"info",websocketEnabled:!1,channel:{}},i=$.extend(!0,{},t,e);n.websocketEnabled=i.websocketEnabled,this.isConnected=!1,this.currentSubscriptions=[],this.options=i;var r=function(e){$(this).trigger("disconnect",e)},s=function(e){$(this).trigger("connect",e)},c=this;n.configure(i),n.addListener("/meta/connect",function(e){var n=this.isConnected;this.isConnected=e.successful===!0,!n&&this.isConnected?s.call(this,e):n&&!this.isConnected&&r.call(this,e)}.bind(this)),n.addListener("/meta/disconnect",r),n.addListener("/meta/handshake",function(e){e.successful&&n.batch(function(){$(c.currentSubscriptions).each(function(e,t){n.resubscribe(t)})})}),n.addListener("/meta/subscribe",function(e){$(c).trigger("subscribe",e)}),n.addListener("/meta/unsubscribe",function(e){$(c).trigger("unsubscribe",e)}),n.addListener("/meta/publish",function(e){$(c).trigger("publish",e)}),n.addListener("/meta/unsuccessful",function(e){$(c).trigger("error",e)}),n.handshake(),this.cometd=n};ChannelManager.prototype.getChannel=function(e){e&&!$.isPlainObject(e)&&(e={base:e});var n={transport:this.cometd},t=new Channel($.extend(!0,{},this.options.channel,n,e)),i=t.subscribe;t.subscribe=function(){var e=i.apply(t,arguments);return this.currentSubscriptions=this.currentSubscriptions.concat(e),e}.bind(this);var r=t.unsubscribe;return t.unsubscribe=function(){for(var e=r.apply(t,arguments),n=0;n<this.currentSubscriptions.length;n++)this.currentSubscriptions[n].id===e.id&&this.currentSubscriptions.splice(n,1);return e}.bind(this),t},ChannelManager.prototype.on=function(){$(this).on.apply($(this),arguments)},ChannelManager.prototype.off=function(){$(this).off.apply($(this),arguments)},ChannelManager.prototype.trigger=function(){$(this).trigger.apply($(this),arguments)},module.exports=ChannelManager;
},{"../service/channel-service":24}],8:[function(require,module,exports){
"use strict";var ChannelManager=require("./channel-manager"),classFrom=require("../util/inherit"),urlService=require("../service/url-config-service"),AuthManager=require("./auth-manager"),session=new AuthManager,getFromSessionOrError=function(r,e){if(!r){var n=session.getCurrentUserSessionInfo();if(!n[e])throw new Error(e+" not found. Please log-in again, or specify "+e+" explicitly");r=n[e]}return r},__super=ChannelManager.prototype,EpicenterChannelManager=classFrom(ChannelManager,{constructor:function(r){var e=session.getCurrentUserSessionInfo(),n={server:{account:e.account,project:e.project}},o=$.extend(!0,{},n,e,r),s=urlService(o.server);return o.url||(o.url=s.protocol+"://"+s.host+"/channel/subscribe"),this.options=o,__super.constructor.call(this,o)},getGroupChannel:function(r){r=getFromSessionOrError(r,"groupName");var e=["/group",this.options.server.account,this.options.server.project,r].join("/");return __super.getChannel.call(this,{base:e})},getWorldChannel:function(r,e){var n=$.isPlainObject(r)&&r.id?r.id:r;if(!n)throw new Error("Please specify a world id");e=getFromSessionOrError(e,"groupName");var o=["/game",this.options.server.account,this.options.server.project,e,n].join("/");return __super.getChannel.call(this,{base:o})},getUserChannel:function(r,e,n){var o=$.isPlainObject(e)&&e.id?e.id:e,s=$.isPlainObject(r)&&r.id?r.id:r;if(!s)throw new Error("Please specify a world id");o=getFromSessionOrError(o,"userId"),n=getFromSessionOrError(n,"groupName");var t=["/users",this.options.server.account,this.options.server.project,n,s,o].join("/");return __super.getChannel.call(this,{base:t})}});module.exports=EpicenterChannelManager;
},{"../service/url-config-service":30,"../util/inherit":37,"./auth-manager":6,"./channel-manager":7}],9:[function(require,module,exports){
"use strict";module.exports={EPI_COOKIE_KEY:"epicenter.project.token",EPI_SESSION_KEY:"epicenter.user.session",STRATEGY_SESSION_KEY:"epicenter-scenario"};
},{}],10:[function(require,module,exports){
"use strict";function patchRunService(t,e){if(t.patched)return t;var i=t.do;return t.do=function(r,n,s){var a=Object.keys(specialOperations);return-1===a.indexOf(r)?i.apply(t,arguments):specialOperations[r].call(t,n,s,e)},t.patched=!0,t}function RunManager(t){this.options=$.extend(!0,{},defaults,t),this.run=this.options.run instanceof RunService?this.options.run:new RunService(this.options.run),patchRunService(this.run,this);var e="function"==typeof this.options.strategy?this.options.strategy:strategiesMap[this.options.strategy];if(!e)throw new Error("Specified run creation strategy was invalid:",this.options.strategy);this.strategy=new e(this.run,this.options)}var strategiesMap=require("./run-strategies/strategies-map"),specialOperations=require("./special-operations"),RunService=require("../service/run-api-service"),defaults={strategy:"new-if-initialized"};RunManager.prototype={getRun:function(){return this.strategy.getRun()},reset:function(t){return this.strategy.reset(t)}},module.exports=RunManager;
},{"../service/run-api-service":28,"./run-strategies/strategies-map":19,"./special-operations":21}],11:[function(require,module,exports){
"use strict";var classFrom=require("../../util/inherit"),ConditionalStrategy=require("./conditional-creation-strategy"),__super=ConditionalStrategy.prototype,Strategy=classFrom(ConditionalStrategy,{constructor:function(t,r){__super.constructor.call(this,t,this.createIf,r)},createIf:function(){return!0}});module.exports=Strategy;
},{"../../util/inherit":37,"./conditional-creation-strategy":12}],12:[function(require,module,exports){
"use strict";function setRunInSession(e,t){var n="/"+[urlService.appPath,urlService.accountPath,urlService.projectPath].join("/");n=n.replace(/\/{2,}/g,"/"),sessionStore.set(e,JSON.stringify({runId:t.id}),{root:n})}var makeSeq=require("../../util/make-sequence"),Base=require("./identity-strategy"),SessionStore=require("../../store/store-factory"),classFrom=require("../../util/inherit"),UrlService=require("../../service/url-config-service"),sessionStore=new SessionStore({}),urlService=new UrlService,keyNames=require("../key-names"),defaults={sessionKey:keyNames.STRATEGY_SESSION_KEY},Strategy=classFrom(Base,{constructor:function(e,t,n){if(null==t)throw new Error("Conditional strategy needs a condition to createte a run");this.run=makeSeq(e),this.condition="function"!=typeof t?function(){return t}:t,this.options=$.extend(!0,{},defaults,n),this.runOptions=this.options.run},reset:function(e){var t=this;return this.run.create(this.runOptions,e).then(function(e){return setRunInSession(t.options.sessionKey,e),e.freshlyCreated=!0,e}).start()},getRun:function(){var e=JSON.parse(sessionStore.get(this.options.sessionKey));return e&&e.runId?this._loadAndCheck(e):this.reset()},_loadAndCheck:function(e){var t=!1,n=this;return this.run.load(e.runId,null,{success:function(e,r,s){t=n.condition.call(n,e,s)}}).then(function(e){return t?n.run.original.create(n.runOptions).then(function(e){return setRunInSession(n.options.sessionKey,e),e.freshlyCreated=!0,e}):e}).start()}});module.exports=Strategy;
},{"../../service/url-config-service":30,"../../store/store-factory":34,"../../util/inherit":37,"../../util/make-sequence":38,"../key-names":9,"./identity-strategy":13}],13:[function(require,module,exports){
"use strict";var classFrom=require("../../util/inherit"),Base={};module.exports=classFrom(Base,{constructor:function(e){this.runService=e},reset:function(){return $.Deferred().resolve().promise()},getRun:function(){return $.Deferred().resolve(this.runService).promise()}});
},{"../../util/inherit":37}],14:[function(require,module,exports){
"use strict";var classFrom=require("../../util/inherit"),IdentityStrategy=require("./identity-strategy"),WorldApiAdapter=require("../../service/world-api-adapter"),AuthManager=require("../auth-manager"),defaults={store:{synchronous:!0}},Strategy=classFrom(IdentityStrategy,{constructor:function(e,r){this.runService=e,this.options=$.extend(!0,{},defaults,r),this._auth=new AuthManager,this._loadRun=this._loadRun.bind(this),this.worldApi=new WorldApiAdapter(this.options.run)},reset:function(){var e=this._auth.getCurrentUserSessionInfo(),r=e.userId,t=e.groupName;return this.worldApi.getCurrentWorldForUser(r,t).then(function(e){return this.worldApi.newRunForWorld(e.id)}.bind(this))},getRun:function(){var e=this._auth.getCurrentUserSessionInfo(),r=e.userId,t=e.groupName,n=this.worldApi,i=this,s=$.Deferred();if(!r)return s.reject({statusCode:400,error:"We need an authenticated user to join a multiplayer world. (ERR: no userId in session)"},e).promise();var o=function(r){return r?n.getCurrentRunId({filter:r.id}).then(i._loadRun).then(s.resolve).fail(s.reject):s.reject({statusCode:404,error:"The user is not in any world."},{options:this.options,session:e})},u=function(r){s.reject(r,e,this.options)};return this.worldApi.getCurrentWorldForUser(r,t).then(o).fail(u),s.promise()},_loadRun:function(e,r){return this.runService.load(e,null,r)}});module.exports=Strategy;
},{"../../service/world-api-adapter":32,"../../util/inherit":37,"../auth-manager":6,"./identity-strategy":13}],15:[function(require,module,exports){
"use strict";var classFrom=require("../../util/inherit"),ConditionalStrategy=require("./conditional-creation-strategy"),__super=ConditionalStrategy.prototype,Strategy=classFrom(ConditionalStrategy,{constructor:function(t,e){__super.constructor.call(this,t,this.createIf,e)},createIf:function(t,e){return"persistent"===e.getResponseHeader("pragma")||t.initialized}});module.exports=Strategy;
},{"../../util/inherit":37,"./conditional-creation-strategy":12}],16:[function(require,module,exports){
"use strict";var classFrom=require("../../util/inherit"),ConditionalStrategy=require("./conditional-creation-strategy"),__super=ConditionalStrategy.prototype,Strategy=classFrom(ConditionalStrategy,{constructor:function(t,r){__super.constructor.call(this,t,this.createIf,r)},createIf:function(){return!1}});module.exports=Strategy;
},{"../../util/inherit":37,"./conditional-creation-strategy":12}],17:[function(require,module,exports){
"use strict";var classFrom=require("../../util/inherit"),ConditionalStrategy=require("./conditional-creation-strategy"),__super=ConditionalStrategy.prototype,Strategy=classFrom(ConditionalStrategy,{constructor:function(t,r){__super.constructor.call(this,t,this.createIf,r)},createIf:function(t,r){return"persistent"===r.getResponseHeader("pragma")}});module.exports=Strategy;
},{"../../util/inherit":37,"./conditional-creation-strategy":12}],18:[function(require,module,exports){
"use strict";var classFrom=require("../../util/inherit"),IdentityStrategy=require("./identity-strategy"),StorageFactory=require("../../store/store-factory"),StateApi=require("../../service/state-api-adapter"),keyNames=require("../key-names"),defaults={store:{synchronous:!0}},Strategy=classFrom(IdentityStrategy,{constructor:function(t,e){this.run=t,this.options=$.extend(!0,{},defaults,e),this.runOptions=this.options.run,this._store=new StorageFactory(this.options.store),this.stateApi=new StateApi,this._loadAndCheck=this._loadAndCheck.bind(this),this._restoreRun=this._restoreRun.bind(this),this._getAllRuns=this._getAllRuns.bind(this),this._loadRun=this._loadRun.bind(this)},reset:function(t){return this.run.create(this.runOptions,t).then(function(t){return t.freshlyCreated=!0,t})},getRun:function(){return this._getAllRuns().then(this._loadAndCheck)},_getAllRuns:function(){var t=JSON.parse(this._store.get(keyNames.EPI_SESSION_KEY)||"{}");return this.run.query({"user.id":t.userId||"0000","scope.group":t.groupName})},_loadAndCheck:function(t){if(!t||!t.length)return this.reset();var e=function(t,e){return new Date(e.date)-new Date(t.date)},r=t.sort(e)[0],n=this,s=!1;return this.run.load(r.id,null,{success:function(t,e,r){s="persistent"===r.getResponseHeader("pragma")}}).then(function(t){return s?n._restoreRun(t.id):t})},_restoreRun:function(t){var e=this;return this.stateApi.replay({runId:t}).then(function(t){return e._loadRun(t.run)})},_loadRun:function(t,e){return this.run.load(t,null,e)}});module.exports=Strategy;
},{"../../service/state-api-adapter":29,"../../store/store-factory":34,"../../util/inherit":37,"../key-names":9,"./identity-strategy":13}],19:[function(require,module,exports){
module.exports={"new-if-initialized":require("./new-if-initialized-strategy"),"new-if-persisted":require("./new-if-persisted-strategy"),"new-if-missing":require("./new-if-missing-strategy"),"always-new":require("./always-new-strategy"),multiplayer:require("./multiplayer-strategy"),"persistent-single-player":require("./persistent-single-player-strategy"),none:require("./identity-strategy")};
},{"./always-new-strategy":11,"./identity-strategy":13,"./multiplayer-strategy":14,"./new-if-initialized-strategy":15,"./new-if-missing-strategy":16,"./new-if-persisted-strategy":17,"./persistent-single-player-strategy":18}],20:[function(require,module,exports){
"use strict";function ScenarioManager(e){this.options=$.extend(!0,{},defaults,e),this.runService=this.options.run||new RunService(this.options)}var RunService=require("../service/run-api-service"),defaults={validFilter:{saved:!0}};ScenarioManager.prototype={getRuns:function(e){return this.filter=$.extend(!0,{},this.options.validFilter,e),this.runService.query(this.filter)},loadVariables:function(e){return this.runService.query(this.filter,{include:e})},save:function(e,r){return this._getService(e).save($.extend(!0,{},{saved:!0},r))},archive:function(e){return this._getService(e).save({saved:!1})},_getService:function(e){if("string"==typeof e)return new RunService($.extend(!0,{},this.options,{filter:e}));if("object"==typeof e&&e instanceof RunService)return e;throw new Error("Save method requires a run service or a runId")},getRun:function(e){return new RunService($.extend(!0,{},this.options,{filter:e}))}},module.exports=ScenarioManager;
},{"../service/run-api-service":28}],21:[function(require,module,exports){
"use strict";module.exports={reset:function(e,t,r){return r.reset(t)}};
},{}],22:[function(require,module,exports){
"use strict";function buildStrategy(e,r){return function(t,n){this.runService=t,this.options=n,$.extend(this,{reset:function(){throw new Error("not implementd. Need api changes")},getRun:function(){var t=this;return worldApi.getCurrentRunId({filter:e}).then(function(e){return t.runService.load(e)}).then(function(e){r.resolve.call(this,e,t.runService)}).fail(r.reject)}})}}var WorldApi=require("../service/world-api-adapter"),RunManager=require("./run-manager"),AuthManager=require("./auth-manager"),worldApi;module.exports=function(e){this.options=e||{},$.extend(!0,this.options,e.run),$.extend(!0,this.options,e.world),worldApi=new WorldApi(this.options),this._auth=new AuthManager;var r=this,t={getCurrentWorld:function(e,r){var t=this._auth.getCurrentUserSessionInfo();return e||(e=t.userId),r||(r=t.groupName),worldApi.getCurrentWorldForUser(e,r)},getCurrentRun:function(){function e(e){var n=e.id,i=buildStrategy(n,t),u=$.extend(!0,{},{strategy:i,run:r.options}),o=new RunManager(u);return o.getRun().then(function(e){t.resolve(e,o.runService,o)})}var t=$.Deferred(),n=this._auth.getCurrentUserSessionInfo(),i=n.userId,u=n.groupName;return this.getCurrentWorld(i,u).then(e),t.promise()}};$.extend(this,t)};
},{"../service/world-api-adapter":32,"./auth-manager":6,"./run-manager":10}],23:[function(require,module,exports){
"use strict";var ConfigService=require("./configuration-service"),TransportFactory=require("../transport/http-transport-factory");module.exports=function(r){var e={userName:"",password:"",account:"",transport:{}},t=$.extend({},e,r),o=new ConfigService(t).get("server"),s=$.extend(!0,{},t.transport,{url:o.getAPIPath("authentication")}),a=new TransportFactory(s),n={login:function(r){var e=$.extend(!0,{success:$.noop},t,r);if(!e.userName||!e.password){var o={status:401,statusMessage:"No username or password specified."};return r.error&&r.error.call(this,o),$.Deferred().reject(o).promise()}var s={userName:e.userName,password:e.password};return e.account&&(s.account=e.account),a.post(s,e)},logout:function(r){var e=$.extend(!0,t,s,r);if(!e.token)throw new Error("No token was specified.");var o="/"===e.url.slice(-1)?"":"/";e.url=e.url+o+e.token;var n={};return a.delete(n,e)}};$.extend(this,n)};
},{"../transport/http-transport-factory":36,"./configuration-service":25}],24:[function(require,module,exports){
"use strict";var Channel=function(n){var t={base:"",topicResolver:function(n){return n},transport:null};this.channelOptions=$.extend(!0,{},t,n)},makeName=function(n,t){var e=(n?n+"/"+t:t).replace(/\/\//g,"/").replace(/\/$/,"");return e};Channel.prototype.subscribe=function(n,t){var e=[].concat(n),r=this,a=[],o=r.channelOptions;return o.transport.batch(function(){$.each(e,function(n,e){e=makeName(o.base,o.topicResolver(e)),a.push(o.transport.subscribe(e,t))})}),a[1]?a:a[0]},Channel.prototype.publish=function(n,t){var e=[].concat(n),r=this,a=[],o=r.channelOptions;return o.transport.batch(function(){$.each(e,function(n,e){e=makeName(o.base,o.topicResolver(e)),"*"===e.charAt(e.length-1)&&(e=e.replace(/\*+$/,"")),a.push(o.transport.publish(e,t))})}),a[1]?a:a[0]},Channel.prototype.unsubscribe=function(n){return this.channelOptions.transport.unsubscribe(n),n},module.exports=Channel;
},{}],25:[function(require,module,exports){
"use strict";var urlService=require("./url-config-service");module.exports=function(e){var r={logLevel:"NONE"},t=$.extend({},r,e);return t.server=urlService(t.server),{data:t,setEnv:function(){},get:function(e){return t[e]},set:function(e,r){t[e]=r}}};
},{"./url-config-service":30}],26:[function(require,module,exports){
"use strict";var ConfigService=require("./configuration-service"),StorageFactory=require("../store/store-factory"),qutil=require("../util/query-util"),TransportFactory=require("../transport/http-transport-factory");module.exports=function(r){var t=new StorageFactory({synchronous:!0}),e={root:"/",token:t.get("epicenter.project.token")||"",apiKey:"",domain:"forio.com",transport:{}},o=$.extend({},e,r),n=new ConfigService(o).get("server");o.account&&(n.accountPath=o.account),o.project&&(n.projectPath=o.project);var a=function(r,t){t||(t=o.root);var e=n.getAPIPath("data")+qutil.addTrailingSlash(t);return r&&(e+=qutil.addTrailingSlash(r)),e},u=$.extend(!0,{},o.transport,{url:a});o.token&&(u.headers={Authorization:"Bearer "+o.token});var i=new TransportFactory(u),c={query:function(r,t,e,n){var u=$.extend(!0,{q:t},e),c=$.extend(!0,{},o,n);return c.url=a(r,c.root),i.get(u,c)},save:function(r,t,e){var n;"object"==typeof r?(n=r,e=t):(n={})[r]=t;var u=$.extend(!0,{},o,e);return u.url=a("",u.root),i.post(n,u)},saveAs:function(r,t,e){var n=$.extend(!0,{},o,e);return n.url=a(r,n.root),i.put(t,n)},load:function(r,t,e){var n=$.extend(!0,{},o,e);return n.url=a(r,n.root),i.get(t,n)},remove:function(r,t){var e,n=$.extend(!0,{},o,t);return $.isArray(r)?e={id:r}:(e="",n.url=a(r,n.root)),i.delete(e,n)}};$.extend(this,c)};
},{"../store/store-factory":34,"../transport/http-transport-factory":36,"../util/query-util":40,"./configuration-service":25}],27:[function(require,module,exports){
"use strict";var ConfigService=require("./configuration-service"),TransportFactory=require("../transport/http-transport-factory");module.exports=function(r){var e={userId:"",groupId:"",transport:{}},t=$.extend({},e,r),o=new ConfigService(t).get("server"),n=$.extend(!0,{},t.transport,{url:o.getAPIPath("member/local")}),u=new TransportFactory(n),s={getGroupsByUser:function(r){var e=$.extend(!0,t,r);if(!e.userId)throw new Error("No userId specified.");var o={userId:e.userId};return u.get(o,e)},getGroupDetails:function(r){var e=$.extend(!0,t,n,r);if(!e.groupId)throw new Error("No groupId specified.");var o="/"===e.url.slice(-1)?"":"/";e.url=e.url+o+e.groupId;var s={};return u.get(s,e)}};$.extend(this,s)};
},{"../transport/http-transport-factory":36,"./configuration-service":25}],28:[function(require,module,exports){
"use strict";var ConfigService=require("./configuration-service"),StorageFactory=require("../store/store-factory"),qutil=require("../util/query-util"),rutil=require("../util/run-util"),_pick=require("../util/object-util")._pick,TransportFactory=require("../transport/http-transport-factory"),VariablesService=require("./variables-api-service");module.exports=function(e){var r=new StorageFactory({synchronous:!0}),t={token:r.get("epicenter.project.token")||"",account:"",project:"",filter:"",success:$.noop,error:$.noop,transport:{}},n=$.extend({},t,e),i=new ConfigService(n).get("server");n.account&&(i.accountPath=n.account),n.project&&(i.projectPath=n.project),i.filter=";",i.getFilterURL=function(){var e=i.getAPIPath("run"),r=qutil.toMatrixFormat(n.filter);return r&&(e+=r+"/"),e};var o=$.extend(!0,{},n.transport,{url:i.getFilterURL});n.token&&(o.headers={Authorization:"Bearer "+n.token});var a=new TransportFactory(o),s=function(e){if(e.filter&&(n.filter=e.filter),!n.filter)throw new Error("No filter specified to apply operations against")},u={urlConfig:i,create:function(e,r){var t=$.extend(!0,{},n,r,{url:i.getAPIPath("run")}),o=["model","scope","files"];e="string"==typeof e?{model:e}:_pick(e,o);var s=t.success;return t.success=function(e){return n.filter=e.id,s.apply(this,arguments)},a.post(e,t)},query:function(e,r,t){n.filter=e;var i=$.extend(!0,{},n,t);return a.get(r,i)},filter:function(e,r,t){$.isPlainObject(n.filter)?$.extend(n.filter,e):n.filter=e;var i=$.extend(!0,{},n,t);return a.get(r,i)},load:function(e,r,t){n.filter=e;var i=$.extend(!0,{},n,t);return a.get(r,i)},save:function(e,r){var t=$.extend(!0,{},n,r);return s(t),a.patch(e,t)},"do":function(e,r,t){var o,u;t?(o=r,u=t):$.isPlainObject(r)?(o=null,u=r):o=r;var l=rutil.normalizeOperations(e,o),c=$.extend(!0,{},n,u);s(c);var p=l.args[0].length&&null!==l.args[0]&&void 0!==l.args[0]?l.args[0]:[];return a.post({arguments:p},$.extend(!0,{},c,{url:i.getFilterURL()+"operations/"+l.ops[0]+"/"}))},serial:function(e,r,t){var i=rutil.normalizeOperations(e,r),o=i.ops,a=i.args,s=this,u=$.Deferred(),l=$.extend(!0,{},n,t),c=function(){var e=o.shift(),r=a.shift();s.do(e,r,{success:function(){o.length?c():(u.resolve.apply(this,arguments),l.success.apply(this,arguments))},error:function(){u.reject.apply(this,arguments),l.error.apply(this,arguments)}})};return c(),u.promise()},parallel:function(e,r,t){for(var i=$.Deferred(),o=rutil.normalizeOperations(e,r),a=o.ops,s=o.args,u=$.extend(!0,{},n,t),l=[],c=0;c<a.length;c++)l.push(this.do(a[c],s[c]));return $.when.apply(this,l).done(function(){i.resolve.apply(this,arguments),u.success.apply(this.arguments)}).fail(function(){i.reject.apply(this,arguments),u.error.apply(this.arguments)}),i.promise()}},l={variables:function(e){var r=new VariablesService($.extend(!0,{},n,e,{runService:this}));return r}};$.extend(this,u),$.extend(this,l)};
},{"../store/store-factory":34,"../transport/http-transport-factory":36,"../util/object-util":39,"../util/query-util":40,"../util/run-util":41,"./configuration-service":25,"./variables-api-service":31}],29:[function(require,module,exports){
"use strict";var ConfigService=require("./configuration-service"),TransportFactory=require("../transport/http-transport-factory"),_pick=require("../util/object-util")._pick,apiEndpoint="model/state";module.exports=function(e){var t={},r=$.extend({},t,e),n=new ConfigService(r).get("server"),o=$.extend(!0,{},r.transport,{url:n.getAPIPath(apiEndpoint)});r.token&&(o.headers={Authorization:"Bearer "+r.token});var i=new TransportFactory(o),a={replay:function(e,t){var o=$.extend(!0,{},r,t,{url:n.getAPIPath(apiEndpoint)+e.runId});return e=$.extend(!0,{action:"replay"},_pick(e,"stopBefore")),i.post(e,o)},clone:function(e,t){var o=$.extend(!0,{},r,t,{url:n.getAPIPath(apiEndpoint)+e.runId});return e=$.extend(!0,{action:"clone"},_pick(e,"stopBefore")),i.post(e,o)}};$.extend(this,a)};
},{"../transport/http-transport-factory":36,"../util/object-util":39,"./configuration-service":25}],30:[function(require,module,exports){
"use strict";module.exports=function(t){var o="https",n={"forio.com":"api.forio.com","foriodev.com":"api.epicenter.foriodev.com"},a={protocol:o,api:"",host:function(){var t=window.location.host;return t&&-1===t.indexOf("local")||(t="forio.com"),n[t]?n[t]:"api."+t}(),appPath:function(){var t=window.location.pathname.split("/");return t&&t[1]||""}(),accountPath:function(){var t="",o=window.location.pathname.split("/");return o&&"app"===o[1]&&(t=o[2]),t}(),projectPath:function(){var t="",o=window.location.pathname.split("/");return o&&"app"===o[1]&&(t=o[3]),t}(),getAPIPath:function(t){var o=["run","data"],n=this.protocol+"://"+this.host+"/"+t+"/";return-1!==$.inArray(t,o)&&(n+=this.accountPath+"/"+this.projectPath+"/"),n}};return $.extend(a,t),a};
},{}],31:[function(require,module,exports){
"use strict";var TransportFactory=require("../transport/http-transport-factory");module.exports=function(r){var e={runService:null},t=$.extend({},e,r),n=function(){return t.runService.urlConfig.getFilterURL()+"variables/"},a={url:n};t.token&&(a.headers={Authorization:"Bearer "+t.token});var o=new TransportFactory(a),u={load:function(r,e,a){var u=$.extend(!0,{},t,a);return o.get(e,$.extend({},u,{url:n()+r+"/"}))},query:function(r,e,n){var a=$.extend(!0,{},t,n);return $.isArray(r)&&(r={include:r}),$.extend(r,e),o.get(r,a)},save:function(r,e,n){var a;"object"==typeof r?(a=r,n=e):(a={})[r]=e;var u=$.extend(!0,{},t,n);return o.patch.call(this,a,u)}};$.extend(this,u)};
},{"../transport/http-transport-factory":36}],32:[function(require,module,exports){
"use strict";var ConfigService=require("./configuration-service"),StorageFactory=require("../store/store-factory"),TransportFactory=require("../transport/http-transport-factory"),_pick=require("../util/object-util")._pick,apiEndpoint="multiplayer/game";module.exports=function(e){var t=new StorageFactory({synchronous:!0}),r={token:t.get("epicenter.project.token")||"",project:void 0,account:void 0,group:void 0,transport:{},success:$.noop,error:$.noop},n=$.extend({},r,e),o=new ConfigService(n).get("server"),i=$.extend(!0,{},n.transport,{url:o.getAPIPath(apiEndpoint)});n.token&&(i.headers={Authorization:"Bearer "+n.token});var u=new TransportFactory(i),a=function(e){if(e.filter&&(n.filter=e.filter),!n.filter)throw new Error("No filter specified to apply operations against")},s={create:function(e,t){var r=$.extend(!0,{},n,t,{url:o.getAPIPath(apiEndpoint)}),i=["model","scope","files","roles","optionalRoles","minUsers","group"];e="string"==typeof e?{model:e}:_pick(e,i),$.extend(e,_pick(n,["account","project","group"]));var a=r.success;return r.success=function(e){return n.filter=e.id,a.apply(this,arguments)},u.post(e,r)},update:function(e,t){var r=["roles","optionalRoles","minUsers"];t=t||{},a(t);var i=$.extend(!0,{},n,t,{url:o.getAPIPath(apiEndpoint)+n.filter});return e=_pick(e||{},r),u.patch(e,i)},"delete":function(e){e=e||{},a(e);var t=$.extend(!0,{},n,e,{url:o.getAPIPath(apiEndpoint)+n.filter});return u.delete(null,t)},list:function(e){e=e||{};var t=$.extend(!0,{},n,e,{url:o.getAPIPath(apiEndpoint)}),r=_pick(t,["account","project","group"]);return u.get(r,t)},getWorldsForUser:function(e,t){t=t||{};var r=$.extend(!0,{},n,t,{url:o.getAPIPath(apiEndpoint)}),i=$.extend(_pick(r,["account","project","group"]),{userId:e});return u.get(i,r)},addUsers:function(e,t,r){if(!e)throw new Error("Please provide a list of users to add to the world");e=$.map([].concat(e),function(e){var t=$.isPlainObject(e);if("string"!=typeof e&&!t)throw new Error("Some of the users in the list are not in the valid format: "+e);return t?e:{userId:e}}),$.isPlainObject(t)&&!r&&(r=t,t=null),r=r||{},"string"==typeof t&&(r.filter=t),a(r);var i=$.extend(!0,{},n,r,{url:o.getAPIPath(apiEndpoint)+n.filter+"/users"});return u.post(e,i)},removeUser:function(e,t){if(t=t||{},"string"==typeof e&&(e={userId:e}),!e.userId)throw new Error("You need to pass a userId to remove from the world");a(t);var r=$.extend(!0,{},n,t,{url:o.getAPIPath(apiEndpoint)+n.filter+"/users/"+e.userId});return u.delete(null,r)},getCurrentRunId:function(e){e=e||{},a(e);var t=$.extend(!0,{},n,e,{url:o.getAPIPath(apiEndpoint)+n.filter+"/run"});return u.post(null,t)},getCurrentWorldForUser:function(e,t){var r=$.Deferred(),n=this;return this.getWorldsForUser(e,{group:t}).then(function(e){e.sort(function(e,t){return new Date(t.lastModified)-new Date(e.lastModified)});var t=e[0];r.resolve(t,n)}).fail(r.reject),r.promise()},deleteRun:function(){throw new Error("not implemented")},newRunForWorld:function(e){return this.deleteRun(e).then(function(){return this.getCurrentRunId({filter:e})})}};$.extend(this,s)};
},{"../store/store-factory":34,"../transport/http-transport-factory":36,"../util/object-util":39,"./configuration-service":25}],33:[function(require,module,exports){
"use strict";module.exports=function(e){var o={root:"/",domain:".forio.com"},n=$.extend({},o,e),t={set:function(e,o,t){var r=$.extend(!0,{},n,t),c=r.domain,d=r.root;return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+(c?"; domain="+c:"")+(d?"; path="+d:""),o},get:function(e){var o=new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),n=document.cookie.replace(o,"$1");return n=decodeURIComponent(n)||null},remove:function(e,o){var t=$.extend(!0,{},n,o),r=t.domain,c=t.root;return document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(r?"; domain="+r:"")+(c?"; path="+c:""),e},destroy:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),o=0;o<e.length;o++){var n=decodeURIComponent(e[o]);this.remove(n)}return e}};$.extend(this,t)};
},{}],34:[function(require,module,exports){
"use strict";var store=require("./cookie-store");module.exports=store;
},{"./cookie-store":33}],35:[function(require,module,exports){
"use strict";var qutils=require("../util/query-util");module.exports=function(t){var e={url:"",contentType:"application/json",headers:{},statusCode:{404:$.noop},parameterParser:qutils.toQueryFormat,xhrFields:{withCredentials:!0}},n=$.extend({},e,t),r=function(t){return $.isFunction(t)?t():t},a=function(t,e,a){e=r(e),e=$.isPlainObject(e)||$.isArray(e)?JSON.stringify(e):e;var i=$.extend(!0,{},n,a,{type:t,data:e}),u=["data","url"];if($.each(i,function(t,e){$.isFunction(e)&&-1!==$.inArray(t,u)&&(i[t]=e())}),i.logLevel&&"DEBUG"===i.logLevel){var s=i.success||$.noop;i.success=function(t){s.apply(this,arguments)}}var l=i.beforeSend;return i.beforeSend=function(t){t.requestUrl=(a||{}).url,l&&l.apply(this,arguments)},$.ajax(i)},i={get:function(t,e){var i=$.extend({},n,e);return t=i.parameterParser(r(t)),a.call(this,"GET",t,i)},post:function(){return a.apply(this,["post"].concat([].slice.call(arguments)))},patch:function(){return a.apply(this,["patch"].concat([].slice.call(arguments)))},put:function(){return a.apply(this,["put"].concat([].slice.call(arguments)))},"delete":function(t,e){var i=$.extend({},n,e);if(t=i.parameterParser(r(t)),$.trim(t)){var u=-1===r(i.url).indexOf("?")?"?":"&";i.url=r(i.url)+u+t}return a.call(this,"DELETE",null,i)},head:function(){return a.apply(this,["head"].concat([].slice.call(arguments)))},options:function(){return a.apply(this,["options"].concat([].slice.call(arguments)))}};return $.extend(this,i)};
},{"../util/query-util":40}],36:[function(require,module,exports){
"use strict";var transport=require("./ajax-http-transport");module.exports=transport;
},{"./ajax-http-transport":35}],37:[function(require,module,exports){
"use strict";function inherit(t,r){var o=function(){};o.prototype=r.prototype,t.prototype=new o,t.__super=r.prototype,t.prototype.constructor=t}var extend=function(t){for(var r,o=Array.prototype.slice.call(arguments,1),e=0;e<o.length;e++)if(r=o[e])for(var n in r)t[n]=r[n];return t};module.exports=function(t,r,o){var e,n=t;return e=r&&r.hasOwnProperty("constructor")?r.constructor:function(){return n.apply(this,arguments)},extend(e,n,o),inherit(e,n),r&&extend(e.prototype,r),e};
},{}],38:[function(require,module,exports){
"use strict";function _w(n){if(n&&n.then)return n;var t=$.Deferred();return t.resolve(n),t.promise()}function seq(){function n(r){var e=t.splice(0,1)[0];return e?_w(e(r)).then(n):r}var t=Array.prototype.slice.apply(arguments);return function(t){return n(t).fail(seq.fail)}}function MakeSeq(n){var t={__calls:[],original:n,then:function(n){return this.__calls.push(n),this},start:function(){var n=this;return this.then(function(t){return n.__calls.length=0,t}),seq.apply(null,this.__calls)()},fail:function(n){return seq.fail=n,this}},r=function(n,t){var r=t[n].bind(t);return function(){var n=Array.prototype.slice.apply(arguments);return this.__calls.push(Function.bind.apply(r,[null].concat(n))),this}};for(var e in n)t[e]="function"==typeof n[e]?r(e,n):n[e];return t}module.exports=MakeSeq;
},{}],39:[function(require,module,exports){
"use strict";module.exports={_pick:function(r,e){var i={};for(var n in r)-1!==e.indexOf(n)&&(i[n]=r[n]);return i}};
},{}],40:[function(require,module,exports){
"use strict";module.exports=function(){return{toMatrixFormat:function(t){if(null===t||void 0===t||""===t)return";";if("string"==typeof t||t instanceof String)return t;var r=[],n=["<",">","!"];$.each(t,function(t,i){("string"!=typeof i||-1===$.inArray($.trim(i).charAt(0),n))&&(i="="+i),r.push(t+i)});var i=";"+r.join(";");return i},toQueryFormat:function(t){if(null===t||void 0===t)return"";if("string"==typeof t||t instanceof String)return t;var r=[];$.each(t,function(t,n){$.isArray(n)&&(n=n.join(",")),$.isPlainObject(n)&&(n=JSON.stringify(n)),r.push(t+"="+n)});var n=r.join("&");return n},qsToObject:function(t){if(null===t||void 0===t||""===t)return{};var r=t.split("&"),n={};return $.each(r,function(t,r){var i=r.split("=")[0],e=r.split("=")[1];-1!==e.indexOf(",")&&(e=e.split(",")),n[i]=e}),n},mergeQS:function(t,r){var n=this.qsToObject(this.toQueryFormat(t)),i=this.qsToObject(this.toQueryFormat(r));return $.extend(!0,{},n,i)},addTrailingSlash:function(t){return t?"/"===t.charAt(t.length-1)?t:t+"/":""}}}();
},{}],41:[function(require,module,exports){
"use strict";module.exports=function(){return{normalizeOperations:function(n,r){r||(r=[]);var s={ops:[],args:[]},u=function(n){return null!==n&&void 0!==n?[].concat(n):[]},t=function(n,r){return r||(r={ops:[],args:[]}),$.each(n,function(n,s){r.ops.push(n),r.args.push(u(s))}),r},o=function(n,r){return r||(r={ops:[],args:[]}),r.ops.push(n.name),r.args.push(u(n.params)),r},a=function(n,r){return(n.name?o:t)(n,r)},e=function(n,r,s){return s||(s={ops:[],args:[]}),s.ops.push(n),s.args.push(u(r)),s},i=function(n,s,u){return u||(u={ops:[],args:[]}),$.each(n,function(n,s){$.isPlainObject(s)?a(s,u):e(s,r[n],u)}),u};return $.isPlainObject(n)?a(n,s):$.isArray(n)?i(n,r,s):e(n,r,s),s}}}();
},{}]},{},[5])


//# sourceMappingURL=epicenter.min.js.map